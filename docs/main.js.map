{"version":3,"sources":["webpack://colamone_js/./src/ai.ts","webpack://colamone_js/./src/boardgame.ts"],"names":["Aijs","copyMap","wkMap","Int8Array","isEndX","nearwin","sum1","sum2","isNoneNode","live1","live2","i","num","NUMBERS","isDraw","flag1","flag2","panel_num","hasCanMovePanelX","number","x","y","PIECES","target_x","target_y","target_number","getCanMovePanelX","canMove","idx","push","getNodeMap","turn_player","nodeList","length","nodeMap","evalMap","evalparam","ev","end","cell_p","p","line","deepThinkAllAB","map","depth","a","b","besthand","best_score","hand","map0","sc","thinkAI","undefined","DEFAULT_EVALPARAM","BoardGamejs","init","_a","_b","_c","zoom","window","innerHeight","innerWidth","document","querySelector","classList","remove","add","ctx","getContext","canv_board","createElement","width","CANV_SIZE","height","canv_board2","canv_focus","canv_pieces","canv_shadow","canv_hover_piece","canv_overlay","canv_bk","canv_cover","canv_score","canv_cache","cellSize","demo","canvas","style","RATIO","isTouch","addEventListener","ev_mouseClick","ev_touchMove","ev_mouseMove","ev_radioChange","move_start","move_prev","move_next","move_end","jumpkento","tweetlog","reloadnew","toggle","element","documentElement","bottom","scrollHeight","clientHeight","scroll","shuffleBoard","storage","getItem","setItem","value","String","parseInt","ua","d","s","id","js","fjs","paramObj","getParam","startMap","initString","thisMap","arr","split","red_num","blue_num","getMapByParam","log","logArray","logstr","wkInitMap","wklogArray","arrow","logArr","replace","arw","match","from","to","Math","floor","decodeLog","lv","focus","img_bk","onload","img_bk_loaded","flush","onerror","setTimeout","updateMessage","getElementsByTagName","getElementById","async","src","parentNode","insertBefore","navigator","userAgent","toLowerCase","indexOf","intervalID","setInterval","playDemo","autoLog","intervalID_log","playLog","goaled","cache_on","hover_piece","blueScore","redScore","winner","message","thinktime","thisHand","demo_inc","COLOR_LINE","COLOR_PANEL_4","COLOR_SELECT","COLOR_RED","COLOR_BLUE","COLOR_WHITE","devicePixelRatio","map_list","mouse_x","mouse_y","logPointer","logArray2","Image","parent","localStorage","e","random","ai","calcScore","clearInterval","viewport","screen","setAttribute","test","MSStream","w","w2","abs","orientation","rate","round","getMousePosition","preventDefault","stopPropagation","target","isGoaled","innerHTML","level","endTime","startTime","Date","count","getNodeCount","plus","getTime","afterHand","turn","r","tmp","clientX","touches","event","rect","getBoundingClientRect","left","clientY","top","initflg","cache_flg","ctx_hover","clearRect","drawImage","ctx_board","grad","createLinearGradient","addColorStop","strokeStyle","fillStyle","beginPath","fillRect","strokeRect","drawBoard","ctx_board2","globalAlpha","arc","PI","fill","drawBoard2","ctx_shadow","wkColor","x0","y0","x1","y1","h","shadow_start_x","shadow_start_y","shadow_end_x","shadow_end_y","center","px1","py1","px2","py2","px3","py3","px4","py4","moveTo","lineTo","closePath","drawShadow","ctx_pieces","goal","drawPiece","drawPieceAll","ctx_canv","ctx_focus","createRadialGradient","lineWidth","canm","stroke","drawFocus","ctx_score","fontsize","blue","red","textBaseline","textAlign","shadowBlur","shadowColor","font","fillText","drawScore","ctx_overlay","shadowOffsetX","shadowOffsetY","fillRoundRect","drawOverlay","ctx_cover","drawCover","wkCtx","ctx_bk","save","clip","restore","x_dot","y_dot","toFixed","endgame","JSON","stringify","map_json","GoalTop","GoalBottom","obj","location","search","paramstr","substring","entry","key","decodeURIComponent","encodeLog","x_vec","y_vec","url","href","lang","onLine","open","cookieEnabled","hasItem","sKey","RegExp","escape","cookie","unescape","sValue"],"mappings":"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","file":"main.js","sourcesContent":["/* @license Copyright (c) @kurehajime / source code: https://github.com/kurehajime/colamone_js */\r\n'use strict';\r\nvar Aijs = /** @class */ (function () {\r\n    function Aijs() {\r\n    }\r\n    /**\r\n     * Mapをコピーして返す。\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @return {Object.<number, number>}\r\n     */\r\n    Aijs.copyMap = function (wkMap) {\r\n        return new Int8Array(wkMap);\r\n    };\r\n    /**\r\n     * 終了判定(実質的勝利含む)\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @param  {boolean}  nearwin\r\n     * @return {number} 0:引き分け,1:先手勝利,-1:後手勝利\r\n     */\r\n    Aijs.isEndX = function (wkMap, nearwin) {\r\n        var sum1 = 0;\r\n        var sum2 = 0;\r\n        // ループだと遅いので展開\r\n        if (wkMap[0] > 0) {\r\n            sum1 += wkMap[0];\r\n        }\r\n        if (wkMap[10] > 0) {\r\n            sum1 += wkMap[10];\r\n        }\r\n        if (wkMap[20] > 0) {\r\n            sum1 += wkMap[20];\r\n        }\r\n        if (wkMap[30] > 0) {\r\n            sum1 += wkMap[30];\r\n        }\r\n        if (wkMap[40] > 0) {\r\n            sum1 += wkMap[40];\r\n        }\r\n        if (wkMap[50] > 0) {\r\n            sum1 += wkMap[50];\r\n        }\r\n        if (wkMap[5] * -1 > 0) {\r\n            sum2 += wkMap[5];\r\n        }\r\n        if (wkMap[15] * -1 > 0) {\r\n            sum2 += wkMap[15];\r\n        }\r\n        if (wkMap[25] * -1 > 0) {\r\n            sum2 += wkMap[25];\r\n        }\r\n        if (wkMap[35] * -1 > 0) {\r\n            sum2 += wkMap[35];\r\n        }\r\n        if (wkMap[45] * -1 > 0) {\r\n            sum2 += wkMap[45];\r\n        }\r\n        if (wkMap[55] * -1 > 0) {\r\n            sum2 += wkMap[55];\r\n        }\r\n        if (sum1 >= 8) {\r\n            return 1;\r\n        }\r\n        else if (sum2 <= -8) {\r\n            return -1;\r\n        }\r\n        // 手詰まりは判定\r\n        if (Aijs.isNoneNode(wkMap)) {\r\n            if (sum1 > (-1 * sum2)) {\r\n                return 1;\r\n            }\r\n            else if (sum1 < (-1 * sum2)) {\r\n                return -1;\r\n            }\r\n            else {\r\n                return 0;\r\n            }\r\n        }\r\n        // 実質的判定勝利\r\n        if (nearwin === false && (sum1 !== 0 || sum2 !== 0)) {\r\n            var live1 = 0;\r\n            var live2 = 0;\r\n            for (var i = 0; i <= 35; i++) {\r\n                var num = Aijs.NUMBERS[i] | 0;\r\n                if (wkMap[num] > 0) {\r\n                    live1 += wkMap[num];\r\n                }\r\n                else if (wkMap[num] < 0) {\r\n                    live2 += wkMap[num];\r\n                }\r\n            }\r\n            if (sum1 > (-1 * (live2 + sum2))) {\r\n                return 1;\r\n            }\r\n            else if (-1 * sum2 > (live1 + sum1)) {\r\n                return -1;\r\n            }\r\n        }\r\n        return 0;\r\n    };\r\n    /**\r\n     * 引き分け判定。最後の一個を取るかどうかの判断\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @return {boolean}\r\n     */\r\n    Aijs.isDraw = function (wkMap) {\r\n        var sum1 = 0;\r\n        var sum2 = 0;\r\n        // ループだと遅いので展開\r\n        if (wkMap[0] > 0) {\r\n            sum1 += wkMap[0];\r\n        }\r\n        if (wkMap[10] > 0) {\r\n            sum1 += wkMap[10];\r\n        }\r\n        if (wkMap[20] > 0) {\r\n            sum1 += wkMap[20];\r\n        }\r\n        if (wkMap[30] > 0) {\r\n            sum1 += wkMap[30];\r\n        }\r\n        if (wkMap[40] > 0) {\r\n            sum1 += wkMap[40];\r\n        }\r\n        if (wkMap[50] > 0) {\r\n            sum1 += wkMap[50];\r\n        }\r\n        if (wkMap[5] * -1 > 0) {\r\n            sum2 -= wkMap[5];\r\n        }\r\n        if (wkMap[15] * -1 > 0) {\r\n            sum2 -= wkMap[15];\r\n        }\r\n        if (wkMap[25] * -1 > 0) {\r\n            sum2 -= wkMap[25];\r\n        }\r\n        if (wkMap[35] * -1 > 0) {\r\n            sum2 -= wkMap[35];\r\n        }\r\n        if (wkMap[45] * -1 > 0) {\r\n            sum2 -= wkMap[45];\r\n        }\r\n        if (wkMap[55] * -1 > 0) {\r\n            sum2 -= wkMap[55];\r\n        }\r\n        if (sum1 === sum2) {\r\n            if (!Aijs.isNoneNode(wkMap)) {\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    /**\r\n     * 手詰まり判定\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @return {boolean}\r\n     */\r\n    Aijs.isNoneNode = function (wkMap) {\r\n        var flag1 = false;\r\n        var flag2 = false;\r\n        for (var i = 0; i <= 35; i++) {\r\n            var panel_num = Aijs.NUMBERS[i] | 0;\r\n            if (wkMap[panel_num] === 0) {\r\n                continue;\r\n            }\r\n            var canMove = Aijs.hasCanMovePanelX(panel_num, wkMap);\r\n            if (canMove === true) {\r\n                if (wkMap[panel_num] > 0) {\r\n                    flag1 = true;\r\n                }\r\n                else if (wkMap[panel_num] < 0) {\r\n                    flag2 = true;\r\n                }\r\n            }\r\n            if (flag1 && flag2) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * 動かせるマスを返す。Return:[NN,NN,NN...]\r\n     * @param  {number}  panel_num\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @return {boolean}\r\n     */\r\n    Aijs.hasCanMovePanelX = function (panel_num, wkMap) {\r\n        var number = wkMap[panel_num] | 0;\r\n        var x = ~~(panel_num / 10); // [~~]=Math.floor \r\n        var y = ~~(panel_num % 10);\r\n        // アガリのコマは動かしたらダメ。何も無いマスも動かしようがない。\r\n        if ((number > 0 && y === 0) || (number < 0 && y === 5) || number === 0) {\r\n            return false;\r\n        }\r\n        for (var i = 0; i < 9; i++) {\r\n            if (Aijs.PIECES[number + 8][i] === 0) {\r\n                continue;\r\n            }\r\n            var target_x = x + ~~(i % 3) - 1;\r\n            var target_y = y + ~~(i / 3) - 1;\r\n            if (target_y < 0 || target_y > 5 || target_x > 5 || target_x < 0) {\r\n                continue;\r\n            }\r\n            var idx = target_x * 10 + target_y;\r\n            var target_number = wkMap[idx];\r\n            // 自コマとアガリのコマはとったらダメ。\r\n            if ((target_number * number > 0) || (target_number > 0 && target_y === 0) || (target_number < 0 && target_y === 5)) {\r\n                continue;\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    /**\r\n     * 動かせるマスを返す。Return:[NN,NN,NN...]\r\n     * @param  {number}  panel_num\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @return {Array.<number, number>}\r\n     */\r\n    Aijs.getCanMovePanelX = function (panel_num, wkMap) {\r\n        var number = wkMap[panel_num] | 0;\r\n        var x = ~~(panel_num / 10); // [~~]=Math.floor \r\n        var y = ~~(panel_num % 10);\r\n        var canMove = [];\r\n        // アガリのコマは動かしたらダメ。何も無いマスも動かしようがない。\r\n        if ((number > 0 && y === 0) || (number < 0 && y === 5) || number === 0) {\r\n            return canMove;\r\n        }\r\n        for (var i = 0; i < 9; i++) {\r\n            if (Aijs.PIECES[number + 8][i] === 0) {\r\n                continue;\r\n            }\r\n            var target_x = x + ~~(i % 3) - 1;\r\n            var target_y = y + ~~(i / 3) - 1;\r\n            if (target_y < 0 || target_y > 5 || target_x > 5 || target_x < 0) {\r\n                continue;\r\n            }\r\n            var idx = target_x * 10 + target_y;\r\n            var target_number = wkMap[idx] | 0;\r\n            // 自コマとアガリのコマはとったらダメ。\r\n            if ((target_number * number > 0) || (target_number > 0 && target_y === 0) || (target_number < 0 && target_y === 5)) {\r\n                continue;\r\n            }\r\n            canMove.push(idx);\r\n        }\r\n        return canMove;\r\n    };\r\n    /**\r\n     * 起こりうる次の一手を返す。Return:[[q,map0],[qmap1],[q,map2]...] //q=[prev,next]\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @param  {number}  turn_player\r\n     * @return {Array.<number,Array.<Array.<number, number>, Object.<number, number>>>}\r\n     */\r\n    Aijs.getNodeMap = function (wkMap, turn_player) {\r\n        var nodeList = [];\r\n        for (var i = 0; i <= 35; i++) {\r\n            var panel_num = Aijs.NUMBERS[i] | 0;\r\n            if (wkMap[panel_num] * turn_player <= 0 || wkMap[panel_num] === 0) {\r\n                continue;\r\n            }\r\n            var canMove = Aijs.getCanMovePanelX(panel_num, wkMap);\r\n            for (var num = 0; num < canMove.length; num++) {\r\n                var nodeMap = new Int8Array(wkMap);\r\n                nodeMap[canMove[num]] = nodeMap[panel_num];\r\n                nodeMap[panel_num] = 0;\r\n                nodeList.push([[panel_num, canMove[num]], nodeMap]);\r\n            }\r\n        }\r\n        return nodeList;\r\n    };\r\n    /**\r\n     * 盤面を評価して-10000〜+10000で採点数する。\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @param  {boolean}  nearwin\r\n     * @param  {Object.<number, Array.<number>>}  evalparam\r\n     * @return {number}\r\n     */\r\n    Aijs.evalMap = function (wkMap, nearwin, evalparam) {\r\n        var ev = 0;\r\n        // 引き分け判定\r\n        if (Aijs.isDraw(wkMap)) {\r\n            return 0;\r\n        }\r\n        // 終局判定\r\n        var end = Aijs.isEndX(wkMap, nearwin);\r\n        if (end === 1) {\r\n            return +9999999;\r\n        }\r\n        else if (end === -1) {\r\n            return -9999999;\r\n        }\r\n        // 評価\r\n        for (var i = 0; i <= 35; i++) {\r\n            var panel_num = Aijs.NUMBERS[i] | 0;\r\n            var cell_p = 0;\r\n            var p = wkMap[panel_num];\r\n            var line = void 0;\r\n            // コマの評価値を加算\r\n            if (p > 0) {\r\n                line = 5 - (panel_num % 10);\r\n                cell_p += evalparam[p][line]; // ポジションボーナス\r\n            }\r\n            else if (p < 0) {\r\n                line = (panel_num % 10);\r\n                cell_p += evalparam[-1 * p][line] * -1;\r\n            }\r\n            // 評価値に加算。\r\n            ev += cell_p;\r\n        }\r\n        return (ev | 0);\r\n    };\r\n    /**\r\n     * よく考える\r\n     */\r\n    Aijs.deepThinkAllAB = function (map, turn_player, depth, a, b, nearwin, evalparam) {\r\n        var best_score = turn_player * 9999999 * -1;\r\n        var besthand;\r\n        if (depth === 0) {\r\n            best_score = Aijs.evalMap(map, nearwin, evalparam);\r\n            return [besthand, best_score];\r\n        }\r\n        if (a === void 0 || b === void 0) {\r\n            a = 9999999 * turn_player * -1;\r\n            b = 9999999 * turn_player;\r\n        }\r\n        var nodeList = Aijs.getNodeMap(map, turn_player);\r\n        for (var i = 0; i < nodeList.length; i++) {\r\n            var hand = nodeList[i][0];\r\n            var map0 = nodeList[i][1];\r\n            var sc = 0;\r\n            // 必勝            \r\n            var end = Aijs.isEndX(map0, nearwin);\r\n            if (end === turn_player) {\r\n                return [hand, 999999 * turn_player];\r\n            }\r\n            // 必敗\r\n            if (end === turn_player * -1) {\r\n                if (besthand === void 0) {\r\n                    best_score = 999999 * turn_player * -1;\r\n                    besthand = hand;\r\n                }\r\n                continue;\r\n            }\r\n            if (Aijs.isNoneNode(map0)) {\r\n                sc = 0;\r\n            }\r\n            else {\r\n                sc = Aijs.deepThinkAllAB(map0, turn_player * -1, depth - 1, b, a, nearwin, evalparam)[1];\r\n            }\r\n            if (besthand === void 0) {\r\n                best_score = sc;\r\n                besthand = hand;\r\n            }\r\n            if (turn_player === 1 && sc > best_score) {\r\n                best_score = sc;\r\n                besthand = hand;\r\n            }\r\n            else if (turn_player === -1 && sc < best_score) {\r\n                best_score = sc;\r\n                besthand = hand;\r\n            }\r\n            if (turn_player === 1 && a < best_score || turn_player === -1 && a > best_score) {\r\n                a = best_score;\r\n            }\r\n            if (turn_player === 1 && b <= best_score || turn_player === -1 && b >= best_score) {\r\n                break;\r\n            }\r\n        }\r\n        return [besthand, best_score];\r\n    };\r\n    /**\r\n     * 考える\r\n     */\r\n    Aijs.thinkAI = function (map, turn_player, depth, a, b, evalparam) {\r\n        var nearwin = false;\r\n        var hand = [undefined, 0];\r\n        var wkMap = new Int8Array(map);\r\n        if (!evalparam) {\r\n            evalparam = Aijs.DEFAULT_EVALPARAM;\r\n        }\r\n        if (Aijs.isEndX(wkMap, false) !== 0) {\r\n            nearwin = true;\r\n        }\r\n        hand = Aijs.deepThinkAllAB(wkMap, turn_player, depth, a, b, nearwin, evalparam);\r\n        if (hand[1] * turn_player === -999999) {\r\n            hand = Aijs.deepThinkAllAB(wkMap, turn_player, 1, a, b, nearwin, evalparam);\r\n        }\r\n        return hand;\r\n    };\r\n    /**\r\n     * 駒の進める方向\r\n     * @const\r\n     * @type {Array.<Array.<number>>}\r\n     * index+8:コマの数字\r\n     */\r\n    Aijs.PIECES = [\r\n        [0, 0, 0,\r\n            0, 0, 0,\r\n            0, 1, 0],\r\n        [0, 1, 0,\r\n            0, 0, 0,\r\n            0, 1, 0],\r\n        [0, 1, 0,\r\n            0, 0, 0,\r\n            1, 0, 1],\r\n        [1, 0, 1,\r\n            0, 0, 0,\r\n            1, 0, 1],\r\n        [1, 0, 1,\r\n            0, 0, 0,\r\n            1, 1, 1],\r\n        [1, 1, 1,\r\n            0, 0, 0,\r\n            1, 1, 1],\r\n        [1, 0, 1,\r\n            1, 0, 1,\r\n            1, 1, 1],\r\n        [1, 1, 1,\r\n            1, 0, 1,\r\n            1, 1, 1],\r\n        [0, 0, 0,\r\n            0, 0, 0,\r\n            0, 0, 0],\r\n        [1, 1, 1,\r\n            1, 0, 1,\r\n            1, 1, 1],\r\n        [1, 1, 1,\r\n            1, 0, 1,\r\n            1, 0, 1],\r\n        [1, 1, 1,\r\n            0, 0, 0,\r\n            1, 1, 1],\r\n        [1, 1, 1,\r\n            0, 0, 0,\r\n            1, 0, 1],\r\n        [1, 0, 1,\r\n            0, 0, 0,\r\n            1, 0, 1],\r\n        [1, 0, 1,\r\n            0, 0, 0,\r\n            0, 1, 0],\r\n        [0, 1, 0,\r\n            0, 0, 0,\r\n            0, 1, 0],\r\n        [0, 1, 0,\r\n            0, 0, 0,\r\n            0, 0, 0]\r\n    ];\r\n    /**\r\n     * 盤の番号\r\n     * @const\r\n     * @type {Array.<number>}\r\n     */\r\n    Aijs.NUMBERS = [0, 1, 2, 3, 4, 5,\r\n        10, 11, 12, 13, 14, 15,\r\n        20, 21, 22, 23, 24, 25,\r\n        30, 31, 32, 33, 34, 35,\r\n        40, 41, 42, 43, 44, 45,\r\n        50, 51, 52, 53, 54, 55];\r\n    /**\r\n     * 初期評価関数\r\n     * @const\r\n     * @type {Object.<number, Array.<number>>}\r\n     */\r\n    Aijs.DEFAULT_EVALPARAM = [\r\n        [],\r\n        [1800, 1850, 1900, 1950, 2100, 2800],\r\n        [1800, 1860, 1920, 2100, 2400, 3800],\r\n        [1450, 1520, 1590, 1900, 2350, 4450],\r\n        [1450, 1530, 1610, 2050, 2650, 5450],\r\n        [1350, 1440, 1530, 2100, 2850, 6350],\r\n        [1350, 1450, 1550, 2250, 3150, 7350],\r\n        [1250, 1360, 1470, 2300, 3350, 8250],\r\n        [1250, 1370, 1490, 2450, 4350, 11250] //8\r\n    ];\r\n    return Aijs;\r\n}());\r\nexport { Aijs };\r\n","/* @license Copyright (c) @kurehajime / source code: https://github.com/kurehajime/colamone_js */\r\nimport { Aijs } from \"./ai\";\r\n// Class ------------------------------------------------\r\nexport function BoardGamejs() { }\r\n// Header -----------------------------------------------\r\nBoardGamejs.init = init;\r\n// Body ---------------------------------------\r\nvar ctx = null;\r\nvar isTouch = true;\r\nvar goaled = false;\r\nvar canv_board = null;\r\nvar canv_board2 = null;\r\nvar canv_focus = null;\r\nvar canv_pieces = null;\r\nvar canv_shadow = null;\r\nvar canv_hover_piece = null;\r\nvar canv_overlay = null;\r\nvar canv_bk = null;\r\nvar canv_cover = null;\r\nvar canv_score = null;\r\nvar canv_cache = null;\r\nvar cache_on = false;\r\nvar img_bk_loaded = false;\r\nvar hover_piece = null;\r\nvar cellSize = 0;\r\nvar turn_player = 0;\r\nvar blueScore = 0;\r\nvar redScore = 0;\r\nvar winner = null;\r\nvar message = '';\r\nvar thinktime = 0.0;\r\nvar demo = true;\r\nvar autoLog = false;\r\nvar intervalID = null;\r\nvar intervalID_log = null;\r\nvar thisHand = undefined;\r\nvar demo_inc = 0;\r\nvar COLOR_LINE = '#333333';\r\nvar COLOR_PANEL_1 = '#660033';\r\nvar COLOR_PANEL_2 = '#004466';\r\nvar COLOR_PANEL_3 = '#FFFFFF';\r\nvar COLOR_PANEL_4 = '#111111';\r\nvar COLOR_PANEL_5 = '#444444';\r\nvar COLOR_PANEL_6 = '#888888';\r\nvar COLOR_SELECT = '#7fed7f';\r\nvar COLOR_SELECT2 = '#148d14';\r\nvar COLOR_RED = '#E60073';\r\nvar COLOR_BLUE = '#0099E6';\r\nvar COLOR_RED2 = '#E60073';\r\nvar COLOR_BLUE2 = '#0099E6';\r\nvar COLOR_WHITE = '#FFFFFF';\r\nvar RATIO = 1;\r\nif (window.devicePixelRatio !== undefined && window.devicePixelRatio != 1) {\r\n    RATIO = window.devicePixelRatio;\r\n}\r\nvar CANV_SIZE = 500 * RATIO;\r\nvar PIECES = {\r\n    '1': [1, 1, 1,\r\n        1, 0, 1,\r\n        1, 1, 1],\r\n    '2': [1, 1, 1,\r\n        1, 0, 1,\r\n        1, 0, 1],\r\n    '3': [1, 1, 1,\r\n        0, 0, 0,\r\n        1, 1, 1],\r\n    '4': [1, 1, 1,\r\n        0, 0, 0,\r\n        1, 0, 1],\r\n    '5': [1, 0, 1,\r\n        0, 0, 0,\r\n        1, 0, 1],\r\n    '6': [1, 0, 1,\r\n        0, 0, 0,\r\n        0, 1, 0],\r\n    '7': [0, 1, 0,\r\n        0, 0, 0,\r\n        0, 1, 0],\r\n    '8': [0, 1, 0,\r\n        0, 0, 0,\r\n        0, 0, 0],\r\n    '-1': [1, 1, 1,\r\n        1, 0, 1,\r\n        1, 1, 1],\r\n    '-2': [1, 0, 1,\r\n        1, 0, 1,\r\n        1, 1, 1],\r\n    '-3': [1, 1, 1,\r\n        0, 0, 0,\r\n        1, 1, 1],\r\n    '-4': [1, 0, 1,\r\n        0, 0, 0,\r\n        1, 1, 1],\r\n    '-5': [1, 0, 1,\r\n        0, 0, 0,\r\n        1, 0, 1],\r\n    '-6': [0, 1, 0,\r\n        0, 0, 0,\r\n        1, 0, 1],\r\n    '-7': [0, 1, 0,\r\n        0, 0, 0,\r\n        0, 1, 0],\r\n    '-8': [0, 0, 0,\r\n        0, 0, 0,\r\n        0, 1, 0]\r\n};\r\n/*  let thisMap = {\r\n    0: -1, 10: -2, 20: -3, 30: -4, 40: -5, 50: -6,\r\n    1: 0, 11: -8, 21: 0, 31: 0, 41: -7, 51: 0,\r\n    2: 0, 12: 0, 22: 0, 32: 0, 42: 0, 52: 0,\r\n    3: 0, 13: 0, 23: 0, 33: 0, 43: 0, 53: 0,\r\n    4: 0, 14: 7, 24: 0, 34: 0, 44: 8, 54: 0,\r\n    5: 6, 15: 5, 25: 4, 35: 3, 45: 2, 55: 1\r\n  };*/\r\nvar thisMap = new Int8Array([\r\n    -1, 0, 0, 0, 0, 6, 0, 0, 0, 0, -2, -8,\r\n    0, 0, 7, 5, 0, 0, 0, 0, -3, 0, 0, 0,\r\n    0, 4, 0, 0, 0, 0, -4, 0, 0, 0, 0,\r\n    3, 0, 0, 0, 0, -5, -7, 0, 0, 8, 2,\r\n    0, 0, 0, 0, -6, 0, 0, 0, 0, 1\r\n]);\r\nvar map_list = {};\r\nvar LIMIT_1000DAY = 3;\r\nvar mouse_x = 0;\r\nvar mouse_y = 0;\r\nvar startMap;\r\nvar logPointer = 0;\r\nvar logArray = [];\r\nvar logArray2 = [];\r\nvar img_bk = null;\r\nimg_bk = new Image();\r\nimg_bk.src = 'bk.gif';\r\nvar storage = null;\r\ntry {\r\n    if (window == parent && ('localStorage' in window) && window.localStorage !== null) {\r\n        storage = localStorage;\r\n        storage.setItem('test', 0); // Safariのプライベートモードは、できないのにできるって言うからかまをかけてみる。\r\n    }\r\n}\r\ncatch (e) {\r\n    storage = null;\r\n}\r\nif (storage === null) {\r\n    // localStorageが使えない場合\r\n    storage = {}; // ダミー\r\n    storage.getItem = function () { return undefined; };\r\n    storage.setItem = function () { return undefined; };\r\n    if (navigator.cookieEnabled) {\r\n        storage.hasItem = function (sKey) {\r\n            return (new RegExp('(?:^|;\\\\s*)' + escape(sKey).replace(/[\\-\\.\\+\\*]/g, '\\\\$&') + '\\\\s*\\\\=')).test(document.cookie);\r\n        };\r\n        storage.getItem = function (sKey) {\r\n            if (!sKey || !(new RegExp('(?:^|;\\\\s*)' + escape(sKey).replace(/[\\-\\.\\+\\*]/g, '\\\\$&') + '\\\\s*\\\\=')).test(document.cookie)) {\r\n                return null;\r\n            }\r\n            return unescape(document.cookie.replace(new RegExp('(?:^|.*;\\\\s*)' + escape(sKey).replace(/[\\-\\.\\+\\*]/g, '\\\\$&') + '\\\\s*\\\\=\\\\s*((?:[^;](?!;))*[^;]?).*'), '$1'));\r\n        };\r\n        storage.setItem = function (sKey, sValue) {\r\n            if (!sKey || /^(?:expires|max\\-age|path|domain|secure)$/i.test(sKey)) {\r\n                return;\r\n            }\r\n            document.cookie = escape(sKey) + '=' + escape(sValue);\r\n        };\r\n    }\r\n}\r\n/**\r\n * 初期化\r\n */\r\nfunction init() {\r\n    var _a, _b, _c;\r\n    zoom(); // 小さい端末でズーム\r\n    if (window.innerHeight < window.innerWidth) {\r\n        (_a = document.querySelector('.manual')) === null || _a === void 0 ? void 0 : _a.classList.remove(\"hide\");\r\n    }\r\n    else {\r\n        (_b = document.querySelector('.manual')) === null || _b === void 0 ? void 0 : _b.classList.add(\"hide\");\r\n    }\r\n    ctx = (_c = document.querySelector('#canv')) === null || _c === void 0 ? void 0 : _c.getContext('2d');\r\n    canv_board = document.createElement('canvas');\r\n    canv_board.width = CANV_SIZE;\r\n    canv_board.height = CANV_SIZE;\r\n    canv_board2 = document.createElement('canvas');\r\n    canv_board2.width = CANV_SIZE;\r\n    canv_board2.height = CANV_SIZE;\r\n    canv_focus = document.createElement('canvas');\r\n    canv_focus.width = CANV_SIZE;\r\n    canv_focus.height = CANV_SIZE;\r\n    canv_pieces = document.createElement('canvas');\r\n    canv_pieces.width = CANV_SIZE;\r\n    canv_pieces.height = CANV_SIZE;\r\n    canv_shadow = document.createElement('canvas');\r\n    canv_shadow.width = CANV_SIZE;\r\n    canv_shadow.height = CANV_SIZE;\r\n    canv_hover_piece = document.createElement('canvas');\r\n    canv_hover_piece.width = CANV_SIZE;\r\n    canv_hover_piece.height = CANV_SIZE;\r\n    canv_overlay = document.createElement('canvas');\r\n    canv_overlay.width = CANV_SIZE;\r\n    canv_overlay.height = CANV_SIZE;\r\n    canv_bk = document.createElement('canvas');\r\n    canv_bk.width = CANV_SIZE;\r\n    canv_bk.height = CANV_SIZE;\r\n    canv_cover = document.createElement('canvas');\r\n    canv_cover.width = CANV_SIZE;\r\n    canv_cover.height = CANV_SIZE;\r\n    canv_score = document.createElement('canvas');\r\n    canv_score.width = CANV_SIZE;\r\n    canv_score.height = CANV_SIZE;\r\n    canv_cache = document.createElement('canvas');\r\n    canv_cache.width = CANV_SIZE;\r\n    canv_cache.height = CANV_SIZE;\r\n    cellSize = CANV_SIZE / 6;\r\n    turn_player = 1;\r\n    demo = true;\r\n    //retina対応\r\n    ctx.canvas.style.width = CANV_SIZE / RATIO + \"px\";\r\n    ctx.canvas.style.height = CANV_SIZE / RATIO + \"px\";\r\n    ctx.canvas.width = CANV_SIZE;\r\n    ctx.canvas.height = CANV_SIZE;\r\n    if ('ontouchstart' in window) {\r\n        isTouch = true;\r\n    }\r\n    else {\r\n        isTouch = false;\r\n    }\r\n    // イベントを設定\r\n    if (isTouch) {\r\n        document.querySelector('#canv').addEventListener('touchstart', ev_mouseClick);\r\n        document.querySelector('#canv').addEventListener('touchmove', ev_touchMove);\r\n    }\r\n    else {\r\n        document.querySelector('#canv').addEventListener('mousemove', ev_mouseMove);\r\n        document.querySelector('#canv').addEventListener('mouseup', ev_mouseClick);\r\n    }\r\n    document.querySelector('#level').addEventListener('change', ev_radioChange);\r\n    document.querySelector('#prevprev').addEventListener('click', move_start);\r\n    document.querySelector('#prev').addEventListener('click', move_prev);\r\n    document.querySelector('#next').addEventListener('click', move_next);\r\n    document.querySelector('#nextnext').addEventListener('click', move_end);\r\n    document.querySelector('#replay').addEventListener('click', jumpkento);\r\n    document.querySelector('#tweetlog').addEventListener('click', tweetlog);\r\n    document.querySelector('#newgame').addEventListener('click', reloadnew);\r\n    document.querySelector('#collapsible').addEventListener('click', function () {\r\n        document.querySelector('.manual').classList.toggle(\"hide\");\r\n        if (window.innerHeight > window.innerWidth) {\r\n            var element = document.documentElement;\r\n            var bottom = element.scrollHeight - element.clientHeight;\r\n            window.scroll(0, bottom);\r\n        }\r\n    });\r\n    window.addEventListener('orientationchange', zoom);\r\n    shuffleBoard();\r\n    // 連勝記録初期化\r\n    if (!storage.getItem('level_1')) {\r\n        storage.setItem('level_1', 0);\r\n    }\r\n    if (!storage.getItem('level_2')) {\r\n        storage.setItem('level_2', 0);\r\n    }\r\n    if (!storage.getItem('level_3')) {\r\n        storage.setItem('level_3', 0);\r\n    }\r\n    if (!storage.getItem('level_4')) {\r\n        storage.setItem('level_4', 0);\r\n    }\r\n    if (!storage.getItem('level_5')) {\r\n        storage.setItem('level_5', 0);\r\n    }\r\n    // レベル記憶\r\n    if (storage.getItem('level_save') !== undefined && storage.getItem('level_save') !== 'undefined' && storage.getItem('level_save') !== null) {\r\n        document.querySelector('#level').value = String(parseInt(storage.getItem('level_save')));\r\n    }\r\n    else {\r\n        storage.setItem('level_save', 1);\r\n        document.querySelector('#level').value = String(1);\r\n    }\r\n    //document.querySelector('#canv').classList.add(\"hue-rotate1\");\r\n    // パラメータを取得\r\n    var paramObj = getParam();\r\n    // 盤面を初期化\r\n    if (paramObj.init) {\r\n        startMap = getMapByParam(paramObj.init);\r\n        thisMap = Aijs.copyMap(startMap);\r\n    }\r\n    else {\r\n        startMap = Aijs.copyMap(thisMap);\r\n    }\r\n    // ログをデコード\r\n    if (paramObj.log) {\r\n        logArray = decodeLog(paramObj.log, startMap);\r\n    }\r\n    // レベル取得\r\n    if (paramObj.lv) {\r\n        document.querySelector('#level').value = String(parseInt(paramObj.lv));\r\n    }\r\n    if (logArray.length !== 0) {\r\n        document.querySelector('#log').classList.remove(\"hide\");\r\n        document.querySelector('#prevprev').classList.remove(\"hide\");\r\n        document.querySelector('#prev').classList.remove(\"hide\");\r\n        document.querySelector('#next').classList.remove(\"hide\");\r\n        document.querySelector('#nextnext').classList.remove(\"hide\");\r\n        document.querySelector('#span_replay').classList.add(\"hide\");\r\n        document.querySelector('#span_tweetlog').classList.add(\"hide\");\r\n        document.querySelector('#next').focus();\r\n    }\r\n    else {\r\n        document.querySelector('#log').classList.add(\"hide\");\r\n        document.querySelector('#prevprev').classList.add(\"hide\");\r\n        document.querySelector('#prev').classList.add(\"hide\");\r\n        document.querySelector('#next').classList.add(\"hide\");\r\n        document.querySelector('#nextnext').classList.add(\"hide\");\r\n        document.querySelector('#span_replay').classList.add(\"hide\");\r\n        document.querySelector('#span_tweetlog').classList.add(\"hide\");\r\n    }\r\n    // 画像読み込み成功時\r\n    img_bk.onload = function () {\r\n        img_bk_loaded = true;\r\n        flush(true, false);\r\n    };\r\n    // 画像読み込み失敗時\r\n    img_bk.onerror = function () {\r\n        flush(true, false);\r\n    };\r\n    // もう既に読み込み終わってた時\r\n    if (img_bk.width !== 0) {\r\n        img_bk_loaded = true;\r\n        flush(true, false);\r\n    }\r\n    // 2.5秒後に強制描画※Googleの検索結果から飛ぶとなぜか描画が走らない事があるので。\r\n    setTimeout(function () {\r\n        if (img_bk.width !== 0) {\r\n            img_bk_loaded = true;\r\n        }\r\n        flush(true, false);\r\n    }, 2500);\r\n    updateMessage();\r\n    setTweet(); // ツイートボタンを生成\r\n    if (logArray.length === 0) {\r\n        if (isBot() == false) {\r\n            window.setTimeout(function () {\r\n                if (demo == true) {\r\n                    intervalID = window.setInterval(playDemo, 400);\r\n                    playDemo();\r\n                }\r\n            }, 500);\r\n        }\r\n    }\r\n    else {\r\n        demo = false;\r\n        autoLog = true;\r\n        intervalID_log = window.setInterval(playLog, 1000);\r\n    }\r\n    goaled = false;\r\n    flush(true, false);\r\n}\r\n/**\r\n * Demoを再生\r\n */\r\nfunction playDemo() {\r\n    if (intervalID !== null) {\r\n        if (Math.random() > 0.3) {\r\n            ai(2);\r\n        }\r\n        else {\r\n            ai(1);\r\n        }\r\n    }\r\n    demo_inc++;\r\n    calcScore();\r\n    flush(false, false);\r\n    if (winner === 1 || winner === -1 || winner === 0) {\r\n        goaled = true;\r\n        winner = null;\r\n        flush(false, false);\r\n        shuffleBoard();\r\n    }\r\n    if (demo_inc > 42) {\r\n        window.clearInterval(intervalID);\r\n    }\r\n}\r\n/**\r\n * Logを再生\r\n */\r\nfunction playLog() {\r\n    if (intervalID_log !== null && autoLog == true) {\r\n        move_next();\r\n    }\r\n    else {\r\n        clearInterval(intervalID_log);\r\n    }\r\n}\r\n/**\r\n * 小さい画面ではViewportを固定化\r\n */\r\nfunction zoom() {\r\n    var viewport = document.querySelector('meta[name=viewport]');\r\n    if (screen.width < 500 && screen.height < 500) {\r\n        if (screen.width < screen.height) {\r\n            viewport.setAttribute('content', 'width=500,user-scalable=no');\r\n        }\r\n        else {\r\n            viewport.setAttribute('content', 'height=500,user-scalable=no');\r\n        }\r\n    }\r\n    else if (screen.width < 500) {\r\n        viewport.setAttribute('content', 'width=500,user-scalable=no');\r\n    }\r\n    else if (screen.height < 500) {\r\n        viewport.setAttribute('content', 'height=500,user-scalable=no');\r\n    }\r\n    // iOS9のViewportはなぜか機能してくれない。\r\n    if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {\r\n        var w = screen.width;\r\n        var w2 = 520;\r\n        if (Math.abs(window.orientation) !== 0) {\r\n            w = screen.height;\r\n            w2 = 900;\r\n        }\r\n        var rate = Math.round((w / w2) * 1000) / 1000.0;\r\n        if (rate == Math.round(rate)) { // iOS 9のViewportは整数指定すると機能しない\r\n            rate += 0.0001;\r\n        }\r\n        viewport.setAttribute('content', 'initial-scale=' + rate + ', minimum-scale=' + rate + ', maximum-scale=' + rate + ', user-scalable=no');\r\n    }\r\n}\r\n/**\r\n * マウス移動時処理\r\n */\r\nfunction ev_mouseMove(e) {\r\n    getMousePosition(e);\r\n    flush(false, true);\r\n}\r\n/**\r\n * タッチ移動時処理\r\n */\r\nfunction ev_touchMove(e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n}\r\n/**\r\n * マウスクリック時処理\r\n */\r\nfunction ev_mouseClick(e) {\r\n    getMousePosition(e);\r\n    var target = Math.floor(mouse_x / cellSize) * 10 + Math.floor(mouse_y / cellSize);\r\n    if (winner !== null || logArray.length !== 0) {\r\n        reloadnew();\r\n        return true;\r\n    }\r\n    if (demo === true) {\r\n        demo = false;\r\n        thisHand = undefined;\r\n        thisMap = Aijs.copyMap(startMap);\r\n        logArray2 = [];\r\n        flush(false, false);\r\n        winner = null;\r\n        goaled = false;\r\n        turn_player = 1;\r\n        window.clearInterval(intervalID);\r\n        flush(false, false);\r\n        return true;\r\n    }\r\n    if (hover_piece === null) {\r\n        if (thisMap[target] * turn_player > 0) {\r\n            hover_piece = target;\r\n        }\r\n    }\r\n    else {\r\n        if (target == hover_piece) {\r\n            hover_piece = null;\r\n            flush(false, false);\r\n            return;\r\n        }\r\n        var canm = Aijs.getCanMovePanelX(hover_piece, thisMap);\r\n        if (canm.indexOf(target) >= 0) {\r\n            flush(false, true);\r\n            if (isGoaled(thisMap, target, turn_player)) {\r\n                goaled = true;\r\n                flush(false, true);\r\n                setTimeout(function () {\r\n                    goaled = false;\r\n                    flush(false, false);\r\n                }, 2000);\r\n            }\r\n            thisMap[target] = thisMap[hover_piece];\r\n            thisMap[hover_piece] = 0;\r\n            turn_player = turn_player * -1;\r\n            logArray2.push([hover_piece, target]);\r\n            thisHand = [hover_piece, target];\r\n            hover_piece = null;\r\n            // AIが考える。\r\n            message = 'thinking...';\r\n            window.setTimeout(function () {\r\n                flush(false, false);\r\n            }, 50);\r\n            updateMessage();\r\n            if (winner === null) {\r\n                window.setTimeout(function () {\r\n                    ai(parseInt(document.querySelector('#level').value));\r\n                    message = '';\r\n                    updateMessage();\r\n                    flush(false, false);\r\n                }, 250);\r\n            }\r\n        }\r\n    }\r\n    flush(false, false);\r\n}\r\n/**\r\n * ラジオボタン変更時処理\r\n */\r\nfunction ev_radioChange() {\r\n    var num = document.querySelector('#level').value;\r\n    storage.setItem('level_save', num);\r\n    if (storage.getItem('level_' + num) > 0) {\r\n        document.querySelector('#wins').innerHTML = storage.getItem('level_' + num) + ' win!';\r\n    }\r\n    else {\r\n        document.querySelector('#wins').innerHTML = '';\r\n    }\r\n    thisMap = Aijs.copyMap(startMap);\r\n    thisHand = undefined;\r\n    map_list = {};\r\n    logArray2 = [];\r\n    flush(false, false);\r\n}\r\n/**\r\n * AIに考えてもらう。\r\n */\r\nfunction ai(level) {\r\n    var hand;\r\n    var startTime = new Date();\r\n    var endTime;\r\n    // 終盤になったら長考してみる。\r\n    var count = getNodeCount(thisMap) / 2;\r\n    var plus = 0;\r\n    switch (level) {\r\n        case 1:\r\n            if (count <= 7) {\r\n                plus++;\r\n            }\r\n            break;\r\n        case 2:\r\n            if (count <= 8) {\r\n                plus++;\r\n            }\r\n            break;\r\n        case 3:\r\n            if (count <= 10) {\r\n                plus++;\r\n            }\r\n            if (count <= 6) {\r\n                plus++;\r\n            }\r\n            break;\r\n        case 4:\r\n            if (count <= 11) {\r\n                plus++;\r\n            }\r\n            if (count <= 7) {\r\n                plus++;\r\n            }\r\n            break;\r\n        case 5:\r\n            if (count > 16) {\r\n                plus--;\r\n            }\r\n            if (count <= 12) {\r\n                plus++;\r\n            }\r\n            if (count <= 8) {\r\n                plus++;\r\n            }\r\n            break;\r\n        case 6:\r\n            if (count > 16) {\r\n                plus--;\r\n            }\r\n            if (count <= 12) {\r\n                plus++;\r\n            }\r\n            if (count <= 8) {\r\n                plus++;\r\n            }\r\n            break;\r\n    }\r\n    hand = Aijs.thinkAI(thisMap, turn_player, level + plus + 1, undefined, undefined, undefined)[0];\r\n    thisHand = hand;\r\n    if (hand) {\r\n        if (isGoaled(thisMap, hand[1], turn_player)) {\r\n            goaled = true;\r\n            flush(false, true);\r\n            setTimeout(function () {\r\n                goaled = false;\r\n                flush(false, false);\r\n            }, 2000);\r\n        }\r\n        thisMap[hand[1]] = thisMap[hand[0]];\r\n        thisMap[hand[0]] = 0;\r\n        logArray2.push([hand[0], hand[1]]);\r\n        // //フォーカス座標を移す。\r\n        // mouse_x = Math.floor(hand[1] / 10)*cellSize+1\r\n        // mouse_y = Math.floor(hand[1] % 10)*cellSize+1\r\n    }\r\n    turn_player = turn_player * -1;\r\n    endTime = new Date();\r\n    thinktime = (endTime.getTime() - startTime.getTime()) / 1000;\r\n}\r\n/**\r\n * ゴールしたか\r\n */\r\nfunction isGoaled(map, afterHand, turn) {\r\n    if (turn > 0) {\r\n        if (afterHand % 10 === 0) {\r\n            return true;\r\n        }\r\n    }\r\n    else if (turn < 0) {\r\n        if (afterHand % 10 === 5) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * 盤面をシャッフル。\r\n */\r\nfunction shuffleBoard() {\r\n    // クリア\r\n    for (var num in thisMap) {\r\n        thisMap[num] = 0;\r\n    }\r\n    var arr = [1, 2, 3, 4, 5, 6, 7, 8];\r\n    var red_num = [0, 10, 20, 30, 40, 50, 11, 41];\r\n    var blue_num = [55, 45, 35, 25, 15, 5, 44, 14];\r\n    for (var i = arr.length - 1; i >= 0; i--) {\r\n        var r = Math.floor(Math.random() * (i + 1));\r\n        var tmp = arr[i];\r\n        arr[i] = arr[r];\r\n        arr[r] = tmp;\r\n    }\r\n    for (var num in blue_num) {\r\n        thisMap[blue_num[num]] = arr[num];\r\n    }\r\n    for (var num in red_num) {\r\n        thisMap[red_num[num]] = -1 * arr[num];\r\n    }\r\n}\r\n/**\r\n * マウス位置取得\r\n */\r\nfunction getMousePosition(e) {\r\n    var _a;\r\n    if (e == null) {\r\n        return;\r\n    }\r\n    if (!e.clientX) { // SmartPhone\r\n        if (e.touches) {\r\n            e = e.touches[0];\r\n        }\r\n        else if (e.touches) {\r\n            e = e.touches[0];\r\n        }\r\n        else {\r\n            e = (_a = event) === null || _a === void 0 ? void 0 : _a.touches[0];\r\n        }\r\n    }\r\n    var rect = e.target.getBoundingClientRect();\r\n    mouse_x = e.clientX - rect.left;\r\n    mouse_y = e.clientY - rect.top;\r\n    mouse_x = mouse_x * RATIO;\r\n    mouse_y = mouse_y * RATIO;\r\n}\r\n/**\r\n * 画面描画。\r\n */\r\nfunction flush(initflg, cache_flg) {\r\n    var wkMap = new Int8Array(thisMap);\r\n    ctx.clearRect(0, 0, CANV_SIZE, CANV_SIZE);\r\n    if (cache_flg === false) {\r\n        cache_on = false;\r\n    }\r\n    // キャッシュに保存\r\n    if (cache_flg === false || cache_on === false) {\r\n        // 盤面を描画\r\n        ctx.drawImage(drawBoard(initflg), 0, 0, CANV_SIZE, CANV_SIZE);\r\n        // テカリを描画\r\n        ctx.drawImage(drawBoard2(initflg), 0, 0, CANV_SIZE, CANV_SIZE);\r\n        // 選択したコマを除外\r\n        if (hover_piece !== null) {\r\n            wkMap[hover_piece] = 0;\r\n        }\r\n        // 残像を表示\r\n        ctx.drawImage(drawShadow(wkMap, thisHand), 0, 0, CANV_SIZE, CANV_SIZE);\r\n        // コマを表示\r\n        ctx.drawImage(drawPieceAll(wkMap), 0, 0, CANV_SIZE, CANV_SIZE);\r\n        // キャッシュに保存\r\n        var ctx_canv = canv_cache.getContext('2d');\r\n        ctx_canv.clearRect(0, 0, CANV_SIZE, CANV_SIZE);\r\n        ctx_canv.drawImage(ctx.canvas, 0, 0, CANV_SIZE, CANV_SIZE);\r\n        // キャッシュ有効化\r\n        cache_on = true;\r\n    }\r\n    else {\r\n        // キャッシュから描画\r\n        ctx.drawImage(canv_cache, 0, 0, CANV_SIZE, CANV_SIZE);\r\n    }\r\n    // 選択したコマを表示\r\n    ctx.drawImage(drawHoverPiece(), 0, 0, CANV_SIZE, CANV_SIZE);\r\n    if ((mouse_x !== 0 || mouse_y !== 0) && demo === false) {\r\n        // フォーカスを描画\r\n        ctx.drawImage(drawFocus(), 0, 0, CANV_SIZE, CANV_SIZE);\r\n    }\r\n    //スコアを表示\r\n    if (goaled || winner !== null) {\r\n        if (demo === false && autoLog == false) {\r\n            ctx.drawImage(drawScore(), 0, 0, CANV_SIZE, CANV_SIZE);\r\n        }\r\n    }\r\n    // メッセージを描画\r\n    ctx.drawImage(drawOverlay(), 0, 0, CANV_SIZE, CANV_SIZE);\r\n    // カバーを描画\r\n    if (demo === true) {\r\n        ctx.drawImage(drawCover(), 0, 0, CANV_SIZE, CANV_SIZE);\r\n    }\r\n}\r\n/**\r\n * 背景描画\r\n */\r\nfunction drawBk() {\r\n    var ctx_bk = canv_bk.getContext('2d');\r\n    if (img_bk_loaded) {\r\n        ctx_bk.drawImage(img_bk, 0, 0, CANV_SIZE / RATIO, CANV_SIZE / RATIO, 0, 0, CANV_SIZE, CANV_SIZE);\r\n    }\r\n    return canv_bk;\r\n}\r\n/**\r\n * カバー描画\r\n */\r\nfunction drawCover() {\r\n    // 背景\r\n    var ctx_cover = canv_cover.getContext('2d');\r\n    ctx_cover.clearRect(0, 0, CANV_SIZE, CANV_SIZE);\r\n    ctx_cover.globalAlpha = 0.50;\r\n    ctx_cover.fillStyle = '#000000';\r\n    ctx_cover.fillRect(0, 0, CANV_SIZE, CANV_SIZE);\r\n    // 枠\r\n    var x = cellSize * 2;\r\n    var y = cellSize * 3.5;\r\n    ctx_cover.shadowBlur = 20;\r\n    ctx_cover.shadowColor = 'rgba(0, 0, 0, 0.3)';\r\n    ctx_cover.shadowOffsetX = 5;\r\n    ctx_cover.shadowOffsetY = 5;\r\n    ctx_cover.globalAlpha = 0.8;\r\n    ctx_cover.fillStyle = COLOR_WHITE;\r\n    ctx_cover.beginPath();\r\n    fillRoundRect(ctx_cover, x, y, cellSize * 2, cellSize * 1, cellSize / 20);\r\n    ctx_cover.shadowColor = 'rgba(0, 0, 0, 0)';\r\n    ctx_cover.shadowBlur = 0;\r\n    ctx_cover.shadowOffsetX = 0;\r\n    ctx_cover.shadowOffsetY = 0;\r\n    // 文字\r\n    var fontsize = Math.round(cellSize * 0.5);\r\n    var message = 'Play';\r\n    message += (demo_inc % 10 == 0) ? \" \" : \"\";\r\n    ctx_cover.shadowBlur = 0;\r\n    ctx_cover.shadowOffsetX = 0;\r\n    ctx_cover.shadowOffsetY = 0;\r\n    ctx_cover.shadowColor = 'rgba(0, 0, 0, 0)';\r\n    ctx_cover.font = 'bold ' + fontsize + 'px Play,sans-serif';\r\n    ctx_cover.globalAlpha = 1;\r\n    ctx_cover.fillStyle = COLOR_LINE;\r\n    ctx_cover.textBaseline = 'middle';\r\n    ctx_cover.textAlign = 'center';\r\n    ctx_cover.beginPath();\r\n    ctx_cover.fillText(message, cellSize * 3, cellSize * 4);\r\n    // 文字２\r\n    message = 'colamone';\r\n    fontsize = Math.round(cellSize * 1);\r\n    ctx_cover.font = 'bold ' + fontsize + 'px Play,sans-serif';\r\n    ctx_cover.fillStyle = COLOR_WHITE;\r\n    ctx_cover.shadowBlur = 0;\r\n    ctx_cover.beginPath();\r\n    ctx_cover.fillText(message, cellSize * 3, cellSize * 2);\r\n    return canv_cover;\r\n}\r\n/**\r\n * スコア描画\r\n */\r\nfunction drawScore() {\r\n    // 背景\r\n    var ctx_score = canv_score.getContext('2d');\r\n    var message = \"\";\r\n    var fontsize = Math.round(cellSize * 1.5);\r\n    var blue = COLOR_BLUE2;\r\n    var red = COLOR_RED2;\r\n    ctx_score.clearRect(0, 0, CANV_SIZE, CANV_SIZE);\r\n    ctx_score.globalAlpha = 0.4;\r\n    ctx_score.textBaseline = 'middle';\r\n    ctx_score.textAlign = 'center';\r\n    ctx_score.shadowBlur = 10;\r\n    ctx_score.shadowColor = 'rgba(0, 0, 0, 0.5)';\r\n    ctx_score.font = 'bold ' + fontsize + 'px Play,sans-serif';\r\n    // 文字\r\n    ctx_score.globalAlpha = 0.3;\r\n    ctx_score.shadowBlur = 2;\r\n    ctx_score.shadowColor = 'rgba(255, 255, 255, 1)';\r\n    ctx_score.fillStyle = red;\r\n    message = String(redScore);\r\n    ctx_score.beginPath();\r\n    ctx_score.fillText(message, cellSize * 1, cellSize * 3.8);\r\n    // 文字\r\n    message = \"8\";\r\n    ctx_score.beginPath();\r\n    ctx_score.fillText(message, cellSize * 2, cellSize * 5.3);\r\n    //線\r\n    ctx_score.lineWidth = cellSize * 0.2;\r\n    ctx_score.strokeStyle = red;\r\n    ctx_score.beginPath();\r\n    ctx_score.moveTo(cellSize * 0.4, cellSize * 5.55);\r\n    ctx_score.lineTo(cellSize * 2.6, cellSize * 3.55);\r\n    ctx_score.closePath();\r\n    ctx_score.stroke();\r\n    // 文字\r\n    message = String(blueScore);\r\n    ctx_score.fillStyle = blue;\r\n    ctx_score.beginPath();\r\n    ctx_score.fillText(message, cellSize * 4, cellSize * 0.7);\r\n    // 文字\r\n    message = \"8\";\r\n    ctx_score.beginPath();\r\n    ctx_score.fillText(message, cellSize * 5, cellSize * 2.3);\r\n    // 文字\r\n    ctx_score.lineWidth = cellSize * 0.2;\r\n    ctx_score.strokeStyle = blue;\r\n    ctx_score.beginPath();\r\n    ctx_score.moveTo(cellSize * 3.4, cellSize * 2.55);\r\n    ctx_score.lineTo(cellSize * 5.6, cellSize * 0.55);\r\n    ctx_score.closePath();\r\n    ctx_score.stroke();\r\n    return canv_score;\r\n}\r\n/**\r\n * フォーカスを描画\r\n */\r\nfunction drawFocus() {\r\n    // 選択マスを強調\r\n    var x = mouse_x - (mouse_x % cellSize);\r\n    var y = mouse_y - (mouse_y % cellSize);\r\n    var ctx_focus = canv_focus.getContext('2d');\r\n    var grad = ctx_focus.createRadialGradient(x, y, 0, x, y, cellSize);\r\n    grad.addColorStop(0.3, COLOR_SELECT);\r\n    grad.addColorStop(1, COLOR_SELECT2);\r\n    ctx_focus.clearRect(0, 0, CANV_SIZE, CANV_SIZE);\r\n    ctx_focus.globalAlpha = 0.35;\r\n    ctx_focus.fillStyle = grad;\r\n    ctx_focus.lineWidth = 1;\r\n    ctx_focus.beginPath();\r\n    ctx_focus.fillRect(x, y, cellSize, cellSize);\r\n    if (isTouch === true && hover_piece === null) {\r\n        return canv_focus;\r\n    }\r\n    // 移動可能マスを強調\r\n    var target = (x / cellSize) * 10 + (y / cellSize);\r\n    if (thisMap[target] * turn_player > 0) {\r\n        var canm = Aijs.getCanMovePanelX(target, thisMap);\r\n        for (var i = 0; i <= canm.length - 1; i++) {\r\n            x = Math.floor(canm[i] / 10);\r\n            y = Math.floor(canm[i] % 10);\r\n            ctx_focus.globalAlpha = 0.6;\r\n            ctx_focus.strokeStyle = COLOR_SELECT;\r\n            ctx_focus.lineWidth = cellSize / 20;\r\n            ctx_focus.beginPath();\r\n            ctx_focus.arc(x * cellSize + (cellSize / 2), y * cellSize + (cellSize / 2), (cellSize / 2) - (cellSize / 10), 0, Math.PI * 2, false);\r\n            ctx_focus.stroke();\r\n        }\r\n    }\r\n    return canv_focus;\r\n}\r\n/**\r\n * 盤面を描画してCANVASを返す。\r\n */\r\nfunction drawBoard(initflg) {\r\n    if (initflg === false) {\r\n        return canv_board;\r\n    }\r\n    var ctx_board = canv_board.getContext('2d');\r\n    ctx_board.clearRect(0, 0, CANV_SIZE, CANV_SIZE);\r\n    var grad = ctx_board.createLinearGradient(0, 0, CANV_SIZE, CANV_SIZE);\r\n    grad.addColorStop(0, COLOR_PANEL_6);\r\n    grad.addColorStop(0.3, COLOR_PANEL_5);\r\n    grad.addColorStop(1, COLOR_PANEL_4);\r\n    for (var x = 0; x < 6; x++) {\r\n        for (var y = 0; y < 6; y++) {\r\n            // パネル描画\r\n            ctx_board.strokeStyle = COLOR_LINE;\r\n            if (y === 0) {\r\n                ctx_board.fillStyle = COLOR_PANEL_1;\r\n            }\r\n            else if (y == 5) {\r\n                ctx_board.fillStyle = COLOR_PANEL_2;\r\n            }\r\n            else if ((x + y) % 2 === 0) {\r\n                ctx_board.fillStyle = COLOR_PANEL_3;\r\n            }\r\n            else {\r\n                ctx_board.fillStyle = COLOR_PANEL_4;\r\n                ctx_board.fillStyle = grad;\r\n            }\r\n            ctx_board.beginPath();\r\n            ctx_board.fillRect(x * cellSize, y * cellSize, cellSize, cellSize);\r\n            ctx_board.strokeRect(x * cellSize, y * cellSize, cellSize, cellSize);\r\n        }\r\n    }\r\n    return canv_board;\r\n}\r\n/**\r\n * 盤面をテカテカにする。\r\n */\r\nfunction drawBoard2(initflg) {\r\n    if (initflg === false) {\r\n        return canv_board2;\r\n    }\r\n    var ctx_board2 = canv_board2.getContext('2d');\r\n    ctx_board2.clearRect(0, 0, CANV_SIZE, CANV_SIZE);\r\n    ctx_board2.globalAlpha = 0.07;\r\n    ctx_board2.fillStyle = COLOR_WHITE;\r\n    ctx_board2.beginPath();\r\n    ctx_board2.arc(cellSize * 1, -3 * cellSize, 7 * cellSize, 0, Math.PI * 2, false);\r\n    ctx_board2.fill();\r\n    return canv_board2;\r\n}\r\n/**\r\n * 浮遊しているコマを描画する。\r\n */\r\nfunction drawHoverPiece() {\r\n    var ctx_hover = canv_hover_piece.getContext('2d');\r\n    ctx_hover.clearRect(0, 0, CANV_SIZE, CANV_SIZE);\r\n    var x = mouse_x - (cellSize / 2);\r\n    var y = mouse_y - (cellSize / 2);\r\n    if (hover_piece !== null) {\r\n        drawPiece(ctx_hover, x, y, thisMap[hover_piece], false);\r\n    }\r\n    return canv_hover_piece;\r\n}\r\n/**\r\n * コマを描画する。\r\n */\r\nfunction drawPiece(wkCtx, x, y, number, goal) {\r\n    var wkColor;\r\n    // 外枠を描画\r\n    if (number === 0) {\r\n        return wkCtx;\r\n    }\r\n    else if (number > 0) {\r\n        wkColor = COLOR_BLUE;\r\n    }\r\n    else {\r\n        wkColor = COLOR_RED;\r\n    }\r\n    var grad = ctx.createLinearGradient(x, y, x + cellSize, y + cellSize);\r\n    grad.addColorStop(0, 'rgb(255, 255, 255)');\r\n    grad.addColorStop(0.4, wkColor);\r\n    grad.addColorStop(1, wkColor);\r\n    wkCtx.shadowBlur = 10;\r\n    wkCtx.shadowColor = 'rgba(0, 0, 0, 1)';\r\n    wkCtx.shadowOffsetX = 2;\r\n    wkCtx.shadowOffsetY = 2;\r\n    wkCtx.fillStyle = grad;\r\n    wkCtx.beginPath();\r\n    fillRoundRect(wkCtx, x + cellSize / 10, y + cellSize / 10, cellSize - 1 * cellSize / 5, cellSize - 1 * cellSize / 5, cellSize / 20);\r\n    wkCtx.shadowColor = 'rgba(0, 0, 0, 0)';\r\n    wkCtx.shadowBlur = 0;\r\n    wkCtx.shadowOffsetX = 0;\r\n    wkCtx.shadowOffsetY = 0;\r\n    // 曇りエフェクト\r\n    if (img_bk_loaded) {\r\n        wkCtx.globalAlpha = 0.35;\r\n        wkCtx.save();\r\n        wkCtx.clip();\r\n        wkCtx.drawImage(drawBk(), x + cellSize / 10, y + cellSize / 10, cellSize - 1 * cellSize / 5, cellSize - 1 * cellSize / 5);\r\n        wkCtx.restore();\r\n        wkCtx.globalAlpha = 1;\r\n    }\r\n    // 文字を描画。\r\n    wkCtx.fillStyle = COLOR_WHITE;\r\n    var fontsize = Math.round(cellSize * 0.18);\r\n    wkCtx.textBaseline = 'middle';\r\n    wkCtx.textAlign = 'center';\r\n    wkCtx.font = fontsize + \"pt 'Play',Arial\";\r\n    wkCtx.beginPath();\r\n    // 数字を印字\r\n    wkCtx.fillText(String(Math.abs(number)), x + (cellSize / 2), y + (cellSize / 2));\r\n    // 点を描画\r\n    for (var i = 0; i <= PIECES[number].length - 1; i++) {\r\n        if (PIECES[number][i] === 0) {\r\n            continue;\r\n        }\r\n        var x_dot = x + cellSize / 4.16 + (Math.floor(cellSize - 1 * cellSize / 5) / 3) * Math.floor(i % 3.0);\r\n        var y_dot = y + cellSize / 4.16 + (Math.floor(cellSize - 1 * cellSize / 5) / 3) * Math.floor(i / 3.0);\r\n        wkCtx.fillStyle = COLOR_WHITE;\r\n        wkCtx.beginPath();\r\n        wkCtx.arc(x_dot, y_dot, cellSize * 0.06, 0, Math.PI * 2, false);\r\n        wkCtx.fill();\r\n    }\r\n    if (goal) { // 得点を印字\r\n        wkCtx.shadowBlur = 10;\r\n        wkCtx.shadowColor = 'rgba(0, 0, 0, 1)';\r\n        wkCtx.globalAlpha = 1;\r\n        wkCtx.fillStyle = COLOR_WHITE;\r\n        fontsize = Math.round(cellSize * 0.5);\r\n        wkCtx.textBaseline = 'middle';\r\n        wkCtx.textAlign = 'center';\r\n        wkCtx.font = 'bolder ' + fontsize + 'pt Play,Arial ';\r\n        wkCtx.beginPath();\r\n        wkCtx.fillText(String(Math.abs(number)), x + (cellSize / 2), y + (cellSize / 2));\r\n        wkCtx.globalAlpha = 1;\r\n        wkCtx.shadowColor = 'rgba(0, 0, 0, 0)';\r\n        wkCtx.shadowBlur = 0;\r\n    }\r\n    return wkCtx;\r\n}\r\n// 角丸\r\nfunction fillRoundRect(ctx, x, y, w, h, r) {\r\n    ctx.beginPath();\r\n    ctx.moveTo(x + r, y);\r\n    ctx.lineTo(x + w - r, y);\r\n    ctx.arc(x + w - r, y + r, r, Math.PI * 1.5, 0, false);\r\n    ctx.lineTo(x + w, y + h - r);\r\n    ctx.arc(x + w - r, y + h - r, r, 0, Math.PI * 0.5, false);\r\n    ctx.lineTo(x + r, y + h);\r\n    ctx.arc(x + r, y + h - r, r, Math.PI * 0.5, Math.PI, false);\r\n    ctx.lineTo(x, y + r);\r\n    ctx.arc(x + r, y + r, r, Math.PI, Math.PI * 1.5, false);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n}\r\n/**\r\n * コマをすべて描画\r\n */\r\nfunction drawPieceAll(wkMap) {\r\n    var ctx_pieces = canv_pieces.getContext('2d');\r\n    ctx_pieces.clearRect(0, 0, CANV_SIZE, CANV_SIZE);\r\n    for (var x = 0; x < 6; x++) {\r\n        for (var y = 0; y < 6; y++) {\r\n            if (wkMap[x * 10 + y] !== 0) {\r\n                var goal = false;\r\n                if (wkMap[x * 10 + y] > 0 && y === 0) {\r\n                    goal = true;\r\n                }\r\n                else if (wkMap[x * 10 + y] < 0 && y == 5) {\r\n                    goal = true;\r\n                }\r\n                ctx_pieces = drawPiece(ctx_pieces, x * cellSize, y * cellSize, wkMap[x * 10 + y], goal);\r\n            }\r\n        }\r\n    }\r\n    return canv_pieces;\r\n}\r\n/**\r\n * 残像を描画する。\r\n */\r\nfunction drawShadow(wkMap, hand) {\r\n    var ctx_shadow = canv_shadow.getContext('2d');\r\n    ctx_shadow.clearRect(0, 0, CANV_SIZE, CANV_SIZE);\r\n    if (hand === undefined) {\r\n        return canv_shadow;\r\n    }\r\n    var x0 = (hand[0] / 10 | 0);\r\n    var y0 = hand[0] % 10;\r\n    var x1 = (hand[1] / 10 | 0);\r\n    var y1 = hand[1] % 10;\r\n    var h = cellSize - 1 * cellSize / 5;\r\n    var w = cellSize - 1 * cellSize / 5;\r\n    var x = x1 * cellSize + cellSize / 10;\r\n    var y = y1 * cellSize + cellSize / 10;\r\n    var shadow_start_x = x + w / 2;\r\n    var shadow_start_y = y + h / 2;\r\n    var shadow_end_x = shadow_start_x;\r\n    var shadow_end_y = shadow_start_y;\r\n    var number = wkMap[hand[1]];\r\n    var wkColor = '';\r\n    var center = 0;\r\n    var grad;\r\n    if (hand.length != 2) {\r\n        return canv_shadow;\r\n    }\r\n    if (number > 0) {\r\n        wkColor = COLOR_BLUE; // \"#EAEFFD\";   \r\n    }\r\n    else {\r\n        wkColor = COLOR_RED; // \"#FDEAFA\";           \r\n    }\r\n    if (x0 == x1 || y0 == y1) { // 直角移動\r\n        if ((x0 + y0) % 2 === 0 && y0 !== 0 && y0 != 5) {\r\n            center = 0.5;\r\n        }\r\n        else {\r\n            center = 0.3;\r\n        }\r\n        if (x0 < x1) {\r\n            x = x - w + 10;\r\n            shadow_end_x = shadow_end_x - w;\r\n        }\r\n        if (x0 > x1) {\r\n            x = x + w - 10;\r\n            shadow_end_x = shadow_end_x + w;\r\n        }\r\n        if (y0 < y1) {\r\n            y = y - h + 10;\r\n            shadow_end_y = shadow_end_y - h;\r\n        }\r\n        if (y0 > y1) {\r\n            y = y + h - 10;\r\n            shadow_end_y = shadow_end_y + h;\r\n        }\r\n        grad = ctx_shadow.createLinearGradient(shadow_start_x, shadow_start_y, shadow_end_x, shadow_end_y);\r\n        grad.addColorStop(0, wkColor);\r\n        grad.addColorStop(center, wkColor);\r\n        grad.addColorStop(1, 'rgba(255, 255, 255, 0)');\r\n        ctx_shadow.fillStyle = grad;\r\n        ctx_shadow.fillRect(x, y, h, w);\r\n    }\r\n    else { // 斜め移動\r\n        if ((x0 + y0) % 2 === 0 && y0 !== 0 && y0 != 5) {\r\n            center = 0.3;\r\n        }\r\n        else {\r\n            center = 0.5;\r\n        }\r\n        var _a = [0, 0, 0, 0, 0, 0, 0, 0], px1 = _a[0], py1 = _a[1], px2 = _a[2], py2 = _a[3], px3 = _a[4], py3 = _a[5], px4 = _a[6], py4 = _a[7];\r\n        if (x0 < x1 && y0 < y1) {\r\n            px1 = x;\r\n            py1 = y - h;\r\n            px2 = x + w;\r\n            py2 = y;\r\n            px3 = x;\r\n            py3 = y + h;\r\n            px4 = x - w;\r\n            py4 = y;\r\n            shadow_end_x = shadow_end_x - w;\r\n            shadow_end_y = shadow_end_y - h;\r\n            shadow_start_x = shadow_start_x + w * 2;\r\n            shadow_start_y = shadow_start_y + h * 2;\r\n        }\r\n        if (x0 > x1 && y0 > y1) {\r\n            px1 = x + w;\r\n            py1 = y;\r\n            px2 = x + w + w;\r\n            py2 = y + h;\r\n            px3 = x + w;\r\n            py3 = y + h + h;\r\n            px4 = x;\r\n            py4 = y + h;\r\n            shadow_end_x = shadow_end_x + w;\r\n            shadow_end_y = shadow_end_y + h;\r\n            shadow_start_x = shadow_start_x - w * 2;\r\n            shadow_start_y = shadow_start_y - h * 2;\r\n        }\r\n        if (x0 < x1 && y0 > y1) {\r\n            px1 = x;\r\n            py1 = y;\r\n            px2 = x + w;\r\n            py2 = y + h;\r\n            px3 = x;\r\n            py3 = y + h + h;\r\n            px4 = x - w;\r\n            py4 = y + h;\r\n            shadow_end_x = shadow_end_x - w;\r\n            shadow_end_y = shadow_end_y + h;\r\n            shadow_start_x = shadow_start_x + w * 2;\r\n            shadow_start_y = shadow_start_y - h * 2;\r\n        }\r\n        if (x0 > x1 && y0 < y1) {\r\n            px1 = x + w;\r\n            py1 = y - h;\r\n            px2 = x + w + w;\r\n            py2 = y;\r\n            px3 = x + w;\r\n            py3 = y + h;\r\n            px4 = x;\r\n            py4 = y;\r\n            shadow_end_x = shadow_end_x + w;\r\n            shadow_end_y = shadow_end_y - h;\r\n            shadow_start_x = shadow_start_x - w * 2;\r\n            shadow_start_y = shadow_start_y + h * 2;\r\n        }\r\n        ctx_shadow.beginPath();\r\n        ctx_shadow.moveTo(px1, py1);\r\n        ctx_shadow.lineTo(px2, py2);\r\n        ctx_shadow.lineTo(px3, py3);\r\n        ctx_shadow.lineTo(px4, py4);\r\n        ctx_shadow.lineTo(px1, py1);\r\n        ctx_shadow.closePath();\r\n        grad = ctx_shadow.createLinearGradient(shadow_start_x, shadow_start_y, shadow_end_x, shadow_end_y);\r\n        grad.addColorStop(0, wkColor);\r\n        grad.addColorStop(center, wkColor);\r\n        grad.addColorStop(0.97, 'rgba(255, 255, 255, 0)');\r\n        ctx_shadow.fillStyle = grad;\r\n        ctx_shadow.fill();\r\n    }\r\n    return canv_shadow;\r\n}\r\n/**\r\n * メッセージを描画\r\n */\r\nfunction drawOverlay() {\r\n    var ctx_overlay = canv_overlay.getContext('2d');\r\n    var x = cellSize * 1.3;\r\n    var y = cellSize * 2.5;\r\n    ctx_overlay.clearRect(0, 0, CANV_SIZE, CANV_SIZE);\r\n    if (message === '') {\r\n        return canv_overlay;\r\n    }\r\n    ctx_overlay.shadowBlur = 10;\r\n    ctx_overlay.shadowColor = 'rgba(100, 100, 100, 0.5)';\r\n    ctx_overlay.shadowOffsetX = 5;\r\n    ctx_overlay.shadowOffsetY = 5;\r\n    ctx_overlay.globalAlpha = 0.9;\r\n    ctx_overlay.fillStyle = COLOR_WHITE;\r\n    fillRoundRect(ctx_overlay, x, y, cellSize * 3.4, cellSize * 1, cellSize / 20);\r\n    var fontsize = Math.round(cellSize * 0.36);\r\n    ctx_overlay.shadowBlur = 0;\r\n    ctx_overlay.shadowOffsetX = 0;\r\n    ctx_overlay.shadowOffsetY = 0;\r\n    ctx_overlay.shadowColor = 'rgba(0, 0, 0, 0)';\r\n    ctx_overlay.font = 'bold ' + fontsize + 'px Play,sans-serif';\r\n    ctx_overlay.globalAlpha = 1;\r\n    ctx_overlay.fillStyle = COLOR_LINE;\r\n    ctx_overlay.textBaseline = 'middle';\r\n    ctx_overlay.textAlign = 'center';\r\n    ctx_overlay.beginPath();\r\n    ctx_overlay.fillText(message, cellSize * 3, cellSize * 3);\r\n    return canv_overlay;\r\n}\r\n/**\r\n * メッセージを更新\r\n */\r\nfunction updateMessage() {\r\n    calcScore();\r\n    var Block = '';\r\n    document.querySelector('#blue').innerHTML = 'Blue: ' + blueScore + '/8';\r\n    document.querySelector('#red').innerHTML = ' Red: ' + redScore + '/8';\r\n    document.querySelector('#time').innerHTML = '(' + (thinktime.toFixed(3)) + 'sec)';\r\n    if (logArray.length === 0) {\r\n        if (winner == 1) {\r\n            message = 'You win!';\r\n            storage.setItem('level_' + document.querySelector('#level').value, parseInt(storage.getItem('level_' + document.querySelector('#level').value)) + 1);\r\n            endgame();\r\n        }\r\n        else if (winner == -1) {\r\n            message = 'You lose...';\r\n            storage.setItem('level_' + document.querySelector('#level').value, 0);\r\n            endgame();\r\n        }\r\n        else if (winner === 0) {\r\n            if (map_list[JSON.stringify(thisMap)] >= LIMIT_1000DAY) {\r\n                message = '3fold repetition';\r\n            }\r\n            else {\r\n                message = '-- Draw --';\r\n            }\r\n            endgame();\r\n        }\r\n    }\r\n    if (storage.getItem('level_' + document.querySelector('#level').value) > 0) {\r\n        document.querySelector('#wins').innerHTML = storage.getItem('level_' + document.querySelector('#level').value) + ' win!';\r\n    }\r\n    else {\r\n        document.querySelector('#wins').innerHTML = '';\r\n    }\r\n}\r\n/**\r\n * ゲーム終了\r\n */\r\nfunction endgame() {\r\n    if (logArray.length === 0) {\r\n        document.querySelector('#span_replay').classList.remove(\"hide\");\r\n        document.querySelector('#span_tweetlog').classList.remove(\"hide\");\r\n    }\r\n}\r\n/**\r\n * 得点計算。\r\n */\r\nfunction calcScore() {\r\n    var sum1 = 0;\r\n    var sum2 = 0;\r\n    var GoalTop = [0, 10, 20, 30, 40, 50];\r\n    var GoalBottom = [5, 15, 25, 35, 45, 55];\r\n    // 点数勝利        \r\n    for (var i in GoalTop) {\r\n        if (thisMap[GoalTop[i]] * 1 > 0) {\r\n            sum1 += thisMap[GoalTop[i]];\r\n        }\r\n    }\r\n    for (var i in GoalBottom) {\r\n        if (thisMap[GoalBottom[i]] * -1 > 0) {\r\n            sum2 += thisMap[GoalBottom[i]];\r\n        }\r\n    }\r\n    if (sum1 >= 8) {\r\n        winner = 1;\r\n    }\r\n    else if (sum2 <= -8) {\r\n        winner = -1;\r\n    }\r\n    // 手詰まりは判定\r\n    if (isNoneNode(thisMap)) {\r\n        if (Math.abs(sum1) > Math.abs(sum2)) {\r\n            winner = 1;\r\n        }\r\n        else if (Math.abs(sum1) < Math.abs(sum2)) { // 引き分けは後攻勝利\r\n            winner = -1;\r\n        }\r\n        else if (Math.abs(sum1) == Math.abs(sum2)) {\r\n            winner = 0;\r\n        }\r\n    }\r\n    else {\r\n        if (is1000day(thisMap) === true) {\r\n            winner = 0;\r\n        }\r\n    }\r\n    blueScore = Math.abs(sum1);\r\n    redScore = Math.abs(sum2);\r\n}\r\n/**\r\n * 手詰まり判定。\r\n */\r\nfunction isNoneNode(wkMap) {\r\n    var flag1 = false;\r\n    var flag2 = false;\r\n    for (var panel_num in wkMap) {\r\n        if (wkMap[panel_num] === 0) {\r\n            continue;\r\n        }\r\n        var canMove = Aijs.getCanMovePanelX(parseInt(panel_num), wkMap);\r\n        if (canMove.length !== 0) {\r\n            if (wkMap[panel_num] > 0) {\r\n                flag1 = true;\r\n            }\r\n            else if (wkMap[panel_num] < 0) {\r\n                flag2 = true;\r\n            }\r\n        }\r\n        if (flag1 && flag2) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n/**\r\n * 千日手\r\n */\r\nfunction is1000day(wkMap) {\r\n    var map_json = JSON.stringify(wkMap);\r\n    if (map_list[map_json] === undefined) {\r\n        map_list[map_json] = 1;\r\n        return false;\r\n    }\r\n    else {\r\n        map_list[map_json] += 1;\r\n    }\r\n    if (map_list[map_json] >= LIMIT_1000DAY) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * 手の数を取得\r\n */\r\nfunction getNodeCount(wkMap) {\r\n    var count = 0;\r\n    for (var panel_num in wkMap) {\r\n        if (wkMap[panel_num] === 0) {\r\n            continue;\r\n        }\r\n        var canMove = Aijs.getCanMovePanelX(parseInt(panel_num), wkMap);\r\n        count += canMove.length;\r\n    }\r\n    return count;\r\n}\r\n/**\r\n * パラメータ取得\r\n */\r\nfunction getParam() {\r\n    var obj = {};\r\n    if (1 < document.location.search.length) {\r\n        var paramstr = document.location.search.substring(1).split('&');\r\n        for (var i = 0; i < paramstr.length; i++) {\r\n            var entry = paramstr[i].split('=');\r\n            var key = decodeURIComponent(entry[0]);\r\n            var value = decodeURIComponent(entry[1]);\r\n            obj[key] = decodeURIComponent(value);\r\n        }\r\n    }\r\n    return obj;\r\n}\r\n/**\r\n * パタメータから初期配置を取得\r\n */\r\nfunction getMapByParam(initString) {\r\n    var wkMap;\r\n    if (initString) {\r\n        wkMap = Aijs.copyMap(thisMap);\r\n        // クリア\r\n        for (var num in wkMap) {\r\n            wkMap[num] = 0;\r\n        }\r\n        var arr = initString.split(',');\r\n        if (arr.length < 8) {\r\n            arr = [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\"];\r\n        }\r\n        var red_num = [0, 10, 20, 30, 40, 50, 11, 41];\r\n        var blue_num = [55, 45, 35, 25, 15, 5, 44, 14];\r\n        for (var num in blue_num) {\r\n            wkMap[blue_num[num]] = parseInt(arr[num]);\r\n        }\r\n        for (var num in red_num) {\r\n            wkMap[red_num[num]] = -1 * parseInt(arr[num]);\r\n        }\r\n    }\r\n    return wkMap;\r\n}\r\n/**\r\n * ログをデコード。\r\n */\r\nfunction decodeLog(logstr, wkInitMap) {\r\n    var wklogArray = [];\r\n    var wkMap = Aijs.copyMap(wkInitMap);\r\n    var arrow = {\r\n        'q': 0, 'w': 1, 'e': 2,\r\n        'a': 3, 's': 4, 'd': 5,\r\n        'z': 6, 'x': 7, 'c': 8\r\n    };\r\n    logstr = logstr.replace(/q/g, 'q,').replace(/w/g, 'w,').replace(/e/g, 'e,');\r\n    logstr = logstr.replace(/a/g, 'a,').replace(/s/g, 's,').replace(/d/g, 'd,');\r\n    logstr = logstr.replace(/z/g, 'z,').replace(/x/g, 'x,').replace(/c/g, 'c,');\r\n    var logArr = logstr.split(',');\r\n    wklogArray.push(wkMap);\r\n    for (var i = 0; i < logArr.length; i++) {\r\n        if (logArr[i] === '') {\r\n            continue;\r\n        }\r\n        var arw = arrow[logArr[i].match(/[qweasdzxc]/)[0]];\r\n        var from = parseInt(logArr[i].match(/\\d*/)[0]);\r\n        var to = (Math.floor(from / 10) + Math.floor(arw % 3) - 1) * 10 +\r\n            (Math.floor(from % 10) + Math.floor(arw / 3) - 1);\r\n        wkMap = Aijs.copyMap(wkMap);\r\n        wkMap[to] = wkMap[from];\r\n        wkMap[from] = 0;\r\n        wklogArray.push(wkMap);\r\n    }\r\n    return wklogArray;\r\n}\r\n/**\r\n * ログをエンコード\r\n */\r\nfunction encodeLog(wklogArray) {\r\n    var logstr = '';\r\n    var arrow = ['q', 'w', 'e',\r\n        'a', 's', 'd',\r\n        'z', 'x', 'c'];\r\n    for (var i in wklogArray) {\r\n        var from = wklogArray[i][0];\r\n        var to = wklogArray[i][1];\r\n        var x_vec = ((Math.floor(to / 10)) - Math.floor(from / 10));\r\n        var y_vec = ((Math.floor(to % 10)) - Math.floor(from % 10));\r\n        var arw = '';\r\n        if (x_vec === -1 && y_vec === -1) {\r\n            arw = 'q';\r\n        }\r\n        if (x_vec === 0 && y_vec === -1) {\r\n            arw = 'w';\r\n        }\r\n        if (x_vec === 1 && y_vec === -1) {\r\n            arw = 'e';\r\n        }\r\n        if (x_vec === -1 && y_vec === 0) {\r\n            arw = 'a';\r\n        }\r\n        if (x_vec === 0 && y_vec === 0) {\r\n            arw = 's';\r\n        }\r\n        if (x_vec === 1 && y_vec === 0) {\r\n            arw = 'd';\r\n        }\r\n        if (x_vec === -1 && y_vec === 1) {\r\n            arw = 'z';\r\n        }\r\n        if (x_vec === 0 && y_vec === 1) {\r\n            arw = 'x';\r\n        }\r\n        if (x_vec === 1 && y_vec === 1) {\r\n            arw = 'c';\r\n        }\r\n        logstr += from + arw;\r\n    }\r\n    return logstr;\r\n}\r\n/**\r\n * ログを全部巻き戻す\r\n */\r\nfunction move_start() {\r\n    logPointer = 0;\r\n    autoLog = false;\r\n    thisMap = Aijs.copyMap(logArray[logPointer]);\r\n    winner = null;\r\n    goaled = false;\r\n    updateMessage();\r\n    flush(false, false);\r\n}\r\n/**\r\n * ログを戻す\r\n */\r\nfunction move_prev() {\r\n    if (logPointer <= 0) {\r\n        return;\r\n    }\r\n    autoLog = false;\r\n    logPointer -= 1;\r\n    thisMap = Aijs.copyMap(logArray[logPointer]);\r\n    winner = null;\r\n    goaled = false;\r\n    updateMessage();\r\n    flush(false, false);\r\n}\r\n/**\r\n * ログを進める\r\n */\r\nfunction move_next() {\r\n    if (logPointer + 1 > logArray.length - 1) {\r\n        return;\r\n    }\r\n    logPointer += 1;\r\n    thisMap = Aijs.copyMap(logArray[logPointer]);\r\n    updateMessage();\r\n    flush(false, false);\r\n}\r\n/**\r\n * ログを最後まで進める。\r\n */\r\nfunction move_end() {\r\n    logPointer = logArray.length - 1;\r\n    autoLog = false;\r\n    thisMap = Aijs.copyMap(logArray[logPointer]);\r\n    updateMessage();\r\n    flush(false, false);\r\n}\r\n/**\r\n * リセット\r\n */\r\nfunction reloadnew() {\r\n    var url = document.location.href.split('?')[0];\r\n    //demo中ならdemoを終了\r\n    if (demo === true) {\r\n        ev_mouseClick(null);\r\n        return;\r\n    }\r\n    // パラメータを取得\r\n    var paramObj = getParam();\r\n    if (paramObj.lang) {\r\n        url += '?lang=' + paramObj.lang;\r\n    }\r\n    if (navigator.onLine) {\r\n        location.href = url;\r\n    }\r\n    else {\r\n        thisMap = Aijs.copyMap(startMap);\r\n        shuffleBoard();\r\n        logArray2 = [];\r\n        message = '';\r\n        winner = null;\r\n        turn_player = 1;\r\n        flush(false, false);\r\n    }\r\n}\r\n/**\r\n * 検討画面に飛ぶ\r\n */\r\nfunction jumpkento() {\r\n    var url = document.location.href.split('?')[0];\r\n    var init = '?init=' + startMap[55] + ',' +\r\n        startMap[45] + ',' +\r\n        startMap[35] + ',' +\r\n        startMap[25] + ',' +\r\n        startMap[15] + ',' +\r\n        startMap[5] + ',' +\r\n        startMap[44] + ',' +\r\n        startMap[14];\r\n    var log = '&log=' + encodeLog(logArray2);\r\n    log += '&lv=' + document.querySelector('#level').value;\r\n    location.href = url + init + log;\r\n}\r\n/**\r\n * ログをツイートする。\r\n */\r\nfunction tweetlog() {\r\n    var url = document.location.href.split('?')[0];\r\n    var init = '?init=' + startMap[55] + ',' +\r\n        startMap[45] + ',' +\r\n        startMap[35] + ',' +\r\n        startMap[25] + ',' +\r\n        startMap[15] + ',' +\r\n        startMap[5] + ',' +\r\n        startMap[44] + ',' +\r\n        startMap[14];\r\n    var log = '%26log=' + encodeLog(logArray2);\r\n    log += '%26lv=' + document.querySelector('#level').value;\r\n    window.open('https://twitter.com/intent/tweet?text=' + url + init + log + '%20%23colamone');\r\n}\r\n/**\r\n * ツイートボタンを読み込む。\r\n */\r\nfunction setTweet() {\r\n    /*jshint -W030 */\r\n    (function f(d, s, id) {\r\n        var js, fjs = d.getElementsByTagName(s)[0];\r\n        if (!d.getElementById(id)) {\r\n            js = d.createElement(s);\r\n            js.id = id;\r\n            js.async = true;\r\n            js.src = 'https://platform.twitter.com/widgets.js';\r\n            fjs.parentNode.insertBefore(js, fjs);\r\n        }\r\n    })(document, 'script', 'twitter-wjs');\r\n}\r\n/**\r\n * botかどうか判定\r\n */\r\nfunction isBot() {\r\n    var ua = window.navigator.userAgent.toLowerCase();\r\n    if (ua.indexOf('bot') != -1 ||\r\n        ua.indexOf('lighthouse') != -1 ||\r\n        ua.indexOf('headless') != -1) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * init\r\n */\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n    BoardGamejs.init();\r\n});\r\n"],"sourceRoot":""}