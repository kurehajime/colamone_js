{"version":3,"sources":["webpack://colamone_js/./src/ai.ts","webpack://colamone_js/./src/boardgame.ts"],"names":["Aijs","copyMap","wkMap","Int8Array","isEndX","nearwin","sum1","sum2","isNoneNode","live1","live2","i","num","NUMBERS","isDraw","flag1","flag2","panel_num","hasCanMovePanelX","number","x","y","PIECES","target_x","target_y","target_number","getCanMovePanelX","canMove","idx","push","getNodeMap","turn_player","nodeList","length","nodeMap","evalMap","evalparam","ev","end","cell_p","p","line","deepThinkAllAB","map","depth","a","b","besthand","best_score","hand","map0","sc","thinkAI","undefined","DEFAULT_EVALPARAM","bg","BoardGamejs","_this","this","ctx","isTouch","goaled","canv_board","canv_board2","canv_focus","canv_pieces","canv_shadow","canv_hover_piece","canv_overlay","canv_bk","canv_cover","canv_score","canv_cache","cache_on","img_bk_loaded","hover_piece","cellSize","blueScore","redScore","winner","message","thinktime","demo","autoLog","intervalID","intervalID_log","thisHand","demo_inc","COLOR_LINE","COLOR_PANEL_1","COLOR_PANEL_2","COLOR_PANEL_3","COLOR_PANEL_4","COLOR_PANEL_5","COLOR_PANEL_6","COLOR_SELECT","COLOR_SELECT2","COLOR_RED","COLOR_BLUE","COLOR_RED2","COLOR_BLUE2","COLOR_WHITE","RATIO","CANV_SIZE","thisMap","map_list","LIMIT_1000DAY","mouse_x","mouse_y","startMap","logPointer","logArray","logArray2","img_bk","storage","ev_mouseMove","e","getMousePosition","flush","ev_touchMove","preventDefault","stopPropagation","ev_mouseClick","target","Math","floor","reloadnew","window","clearInterval","indexOf","isGoaled","setTimeout","updateMessage","ai","parseInt","document","querySelector","value","ev_radioChange","setItem","getItem","innerHTML","devicePixelRatio","Image","src","parent","localStorage","navigator","cookieEnabled","hasItem","sKey","RegExp","escape","replace","test","cookie","unescape","sValue","prototype","Run","_a","_b","_c","zoom","innerHeight","innerWidth","classList","remove","add","getContext","createElement","width","height","canvas","style","addEventListener","passive","move_start","move_prev","move_next","move_end","jumpkento","tweetlog","toggle","element","documentElement","bottom","scrollHeight","clientHeight","scroll","shuffleBoard","String","paramObj","getParam","init","getMapByParam","log","decodeLog","lv","focus","onload","onerror","setTweet","isBot","setInterval","playDemo","playLog","random","calcScore","viewport","screen","setAttribute","userAgent","MSStream","w","w2","abs","orientation","rate","round","level","endTime","startTime","Date","count","getNodeCount","plus","getTime","afterHand","turn","arr","red_num","blue_num","r","tmp","clientX","touches","event","rect","getBoundingClientRect","left","clientY","top","initflg","cache_flg","clearRect","drawImage","drawBoard","drawBoard2","drawShadow","drawPieceAll","ctx_canv","drawHoverPiece","drawFocus","drawScore","drawOverlay","drawCover","drawBk","ctx_bk","ctx_cover","globalAlpha","fillStyle","fillRect","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","beginPath","fillRoundRect","fontsize","font","textBaseline","textAlign","fillText","ctx_score","blue","red","lineWidth","strokeStyle","moveTo","lineTo","closePath","stroke","ctx_focus","grad","createRadialGradient","addColorStop","canm","arc","PI","ctx_board","createLinearGradient","strokeRect","ctx_board2","fill","ctx_hover","drawPiece","wkCtx","goal","wkColor","save","clip","restore","x_dot","y_dot","h","ctx_pieces","ctx_shadow","x0","y0","x1","y1","shadow_start_x","shadow_start_y","shadow_end_x","shadow_end_y","center","px1","py1","px2","py2","px3","py3","px4","py4","ctx_overlay","toFixed","endgame","JSON","stringify","GoalTop","GoalBottom","is1000day","map_json","obj","location","search","paramstr","substring","split","entry","key","decodeURIComponent","initString","logstr","wkInitMap","wklogArray","arrow","logArr","arw","match","from","to","encodeLog","x_vec","y_vec","url","href","lang","onLine","open","d","s","id","js","fjs","getElementsByTagName","getElementById","async","parentNode","insertBefore","ua","toLowerCase"],"mappings":"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","file":"main.js","sourcesContent":["/* @license Copyright (c) @kurehajime / source code: https://github.com/kurehajime/colamone_js */\r\n'use strict';\r\nvar Aijs = /** @class */ (function () {\r\n    function Aijs() {\r\n    }\r\n    /**\r\n     * Mapをコピーして返す。\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @return {Object.<number, number>}\r\n     */\r\n    Aijs.copyMap = function (wkMap) {\r\n        return new Int8Array(wkMap);\r\n    };\r\n    /**\r\n     * 終了判定(実質的勝利含む)\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @param  {boolean}  nearwin\r\n     * @return {number} 0:引き分け,1:先手勝利,-1:後手勝利\r\n     */\r\n    Aijs.isEndX = function (wkMap, nearwin) {\r\n        var sum1 = 0;\r\n        var sum2 = 0;\r\n        // ループだと遅いので展開\r\n        if (wkMap[0] > 0) {\r\n            sum1 += wkMap[0];\r\n        }\r\n        if (wkMap[10] > 0) {\r\n            sum1 += wkMap[10];\r\n        }\r\n        if (wkMap[20] > 0) {\r\n            sum1 += wkMap[20];\r\n        }\r\n        if (wkMap[30] > 0) {\r\n            sum1 += wkMap[30];\r\n        }\r\n        if (wkMap[40] > 0) {\r\n            sum1 += wkMap[40];\r\n        }\r\n        if (wkMap[50] > 0) {\r\n            sum1 += wkMap[50];\r\n        }\r\n        if (wkMap[5] * -1 > 0) {\r\n            sum2 += wkMap[5];\r\n        }\r\n        if (wkMap[15] * -1 > 0) {\r\n            sum2 += wkMap[15];\r\n        }\r\n        if (wkMap[25] * -1 > 0) {\r\n            sum2 += wkMap[25];\r\n        }\r\n        if (wkMap[35] * -1 > 0) {\r\n            sum2 += wkMap[35];\r\n        }\r\n        if (wkMap[45] * -1 > 0) {\r\n            sum2 += wkMap[45];\r\n        }\r\n        if (wkMap[55] * -1 > 0) {\r\n            sum2 += wkMap[55];\r\n        }\r\n        if (sum1 >= 8) {\r\n            return 1;\r\n        }\r\n        else if (sum2 <= -8) {\r\n            return -1;\r\n        }\r\n        // 手詰まりは判定\r\n        if (Aijs.isNoneNode(wkMap)) {\r\n            if (sum1 > (-1 * sum2)) {\r\n                return 1;\r\n            }\r\n            else if (sum1 < (-1 * sum2)) {\r\n                return -1;\r\n            }\r\n            else {\r\n                return 0;\r\n            }\r\n        }\r\n        // 実質的判定勝利\r\n        if (nearwin === false && (sum1 !== 0 || sum2 !== 0)) {\r\n            var live1 = 0;\r\n            var live2 = 0;\r\n            for (var i = 0; i <= 35; i++) {\r\n                var num = Aijs.NUMBERS[i] | 0;\r\n                if (wkMap[num] > 0) {\r\n                    live1 += wkMap[num];\r\n                }\r\n                else if (wkMap[num] < 0) {\r\n                    live2 += wkMap[num];\r\n                }\r\n            }\r\n            if (sum1 > (-1 * (live2 + sum2))) {\r\n                return 1;\r\n            }\r\n            else if (-1 * sum2 > (live1 + sum1)) {\r\n                return -1;\r\n            }\r\n        }\r\n        return 0;\r\n    };\r\n    /**\r\n     * 引き分け判定。最後の一個を取るかどうかの判断\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @return {boolean}\r\n     */\r\n    Aijs.isDraw = function (wkMap) {\r\n        var sum1 = 0;\r\n        var sum2 = 0;\r\n        // ループだと遅いので展開\r\n        if (wkMap[0] > 0) {\r\n            sum1 += wkMap[0];\r\n        }\r\n        if (wkMap[10] > 0) {\r\n            sum1 += wkMap[10];\r\n        }\r\n        if (wkMap[20] > 0) {\r\n            sum1 += wkMap[20];\r\n        }\r\n        if (wkMap[30] > 0) {\r\n            sum1 += wkMap[30];\r\n        }\r\n        if (wkMap[40] > 0) {\r\n            sum1 += wkMap[40];\r\n        }\r\n        if (wkMap[50] > 0) {\r\n            sum1 += wkMap[50];\r\n        }\r\n        if (wkMap[5] * -1 > 0) {\r\n            sum2 -= wkMap[5];\r\n        }\r\n        if (wkMap[15] * -1 > 0) {\r\n            sum2 -= wkMap[15];\r\n        }\r\n        if (wkMap[25] * -1 > 0) {\r\n            sum2 -= wkMap[25];\r\n        }\r\n        if (wkMap[35] * -1 > 0) {\r\n            sum2 -= wkMap[35];\r\n        }\r\n        if (wkMap[45] * -1 > 0) {\r\n            sum2 -= wkMap[45];\r\n        }\r\n        if (wkMap[55] * -1 > 0) {\r\n            sum2 -= wkMap[55];\r\n        }\r\n        if (sum1 === sum2) {\r\n            if (!Aijs.isNoneNode(wkMap)) {\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    /**\r\n     * 手詰まり判定\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @return {boolean}\r\n     */\r\n    Aijs.isNoneNode = function (wkMap) {\r\n        var flag1 = false;\r\n        var flag2 = false;\r\n        for (var i = 0; i <= 35; i++) {\r\n            var panel_num = Aijs.NUMBERS[i] | 0;\r\n            if (wkMap[panel_num] === 0) {\r\n                continue;\r\n            }\r\n            var canMove = Aijs.hasCanMovePanelX(panel_num, wkMap);\r\n            if (canMove === true) {\r\n                if (wkMap[panel_num] > 0) {\r\n                    flag1 = true;\r\n                }\r\n                else if (wkMap[panel_num] < 0) {\r\n                    flag2 = true;\r\n                }\r\n            }\r\n            if (flag1 && flag2) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * 動かせるマスを返す。Return:[NN,NN,NN...]\r\n     * @param  {number}  panel_num\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @return {boolean}\r\n     */\r\n    Aijs.hasCanMovePanelX = function (panel_num, wkMap) {\r\n        var number = wkMap[panel_num] | 0;\r\n        var x = ~~(panel_num / 10); // [~~]=Math.floor \r\n        var y = ~~(panel_num % 10);\r\n        // アガリのコマは動かしたらダメ。何も無いマスも動かしようがない。\r\n        if ((number > 0 && y === 0) || (number < 0 && y === 5) || number === 0) {\r\n            return false;\r\n        }\r\n        for (var i = 0; i < 9; i++) {\r\n            if (Aijs.PIECES[number + 8][i] === 0) {\r\n                continue;\r\n            }\r\n            var target_x = x + ~~(i % 3) - 1;\r\n            var target_y = y + ~~(i / 3) - 1;\r\n            if (target_y < 0 || target_y > 5 || target_x > 5 || target_x < 0) {\r\n                continue;\r\n            }\r\n            var idx = target_x * 10 + target_y;\r\n            var target_number = wkMap[idx];\r\n            // 自コマとアガリのコマはとったらダメ。\r\n            if ((target_number * number > 0) || (target_number > 0 && target_y === 0) || (target_number < 0 && target_y === 5)) {\r\n                continue;\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    /**\r\n     * 動かせるマスを返す。Return:[NN,NN,NN...]\r\n     * @param  {number}  panel_num\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @return {Array.<number, number>}\r\n     */\r\n    Aijs.getCanMovePanelX = function (panel_num, wkMap) {\r\n        var number = wkMap[panel_num] | 0;\r\n        var x = ~~(panel_num / 10); // [~~]=Math.floor \r\n        var y = ~~(panel_num % 10);\r\n        var canMove = [];\r\n        // アガリのコマは動かしたらダメ。何も無いマスも動かしようがない。\r\n        if ((number > 0 && y === 0) || (number < 0 && y === 5) || number === 0) {\r\n            return canMove;\r\n        }\r\n        for (var i = 0; i < 9; i++) {\r\n            if (Aijs.PIECES[number + 8][i] === 0) {\r\n                continue;\r\n            }\r\n            var target_x = x + ~~(i % 3) - 1;\r\n            var target_y = y + ~~(i / 3) - 1;\r\n            if (target_y < 0 || target_y > 5 || target_x > 5 || target_x < 0) {\r\n                continue;\r\n            }\r\n            var idx = target_x * 10 + target_y;\r\n            var target_number = wkMap[idx] | 0;\r\n            // 自コマとアガリのコマはとったらダメ。\r\n            if ((target_number * number > 0) || (target_number > 0 && target_y === 0) || (target_number < 0 && target_y === 5)) {\r\n                continue;\r\n            }\r\n            canMove.push(idx);\r\n        }\r\n        return canMove;\r\n    };\r\n    /**\r\n     * 起こりうる次の一手を返す。Return:[[q,map0],[qmap1],[q,map2]...] //q=[prev,next]\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @param  {number}  turn_player\r\n     * @return {Array.<number,Array.<Array.<number, number>, Object.<number, number>>>}\r\n     */\r\n    Aijs.getNodeMap = function (wkMap, turn_player) {\r\n        var nodeList = [];\r\n        for (var i = 0; i <= 35; i++) {\r\n            var panel_num = Aijs.NUMBERS[i] | 0;\r\n            if (wkMap[panel_num] * turn_player <= 0 || wkMap[panel_num] === 0) {\r\n                continue;\r\n            }\r\n            var canMove = Aijs.getCanMovePanelX(panel_num, wkMap);\r\n            for (var num = 0; num < canMove.length; num++) {\r\n                var nodeMap = new Int8Array(wkMap);\r\n                nodeMap[canMove[num]] = nodeMap[panel_num];\r\n                nodeMap[panel_num] = 0;\r\n                nodeList.push([[panel_num, canMove[num]], nodeMap]);\r\n            }\r\n        }\r\n        return nodeList;\r\n    };\r\n    /**\r\n     * 盤面を評価して-10000〜+10000で採点数する。\r\n     * @param  {Object.<number, number>}  wkMap\r\n     * @param  {boolean}  nearwin\r\n     * @param  {Object.<number, Array.<number>>}  evalparam\r\n     * @return {number}\r\n     */\r\n    Aijs.evalMap = function (wkMap, nearwin, evalparam) {\r\n        var ev = 0;\r\n        // 引き分け判定\r\n        if (Aijs.isDraw(wkMap)) {\r\n            return 0;\r\n        }\r\n        // 終局判定\r\n        var end = Aijs.isEndX(wkMap, nearwin);\r\n        if (end === 1) {\r\n            return +9999999;\r\n        }\r\n        else if (end === -1) {\r\n            return -9999999;\r\n        }\r\n        // 評価\r\n        for (var i = 0; i <= 35; i++) {\r\n            var panel_num = Aijs.NUMBERS[i] | 0;\r\n            var cell_p = 0;\r\n            var p = wkMap[panel_num];\r\n            var line = void 0;\r\n            // コマの評価値を加算\r\n            if (p > 0) {\r\n                line = 5 - (panel_num % 10);\r\n                cell_p += evalparam[p][line]; // ポジションボーナス\r\n            }\r\n            else if (p < 0) {\r\n                line = (panel_num % 10);\r\n                cell_p += evalparam[-1 * p][line] * -1;\r\n            }\r\n            // 評価値に加算。\r\n            ev += cell_p;\r\n        }\r\n        return (ev | 0);\r\n    };\r\n    /**\r\n     * よく考える\r\n     */\r\n    Aijs.deepThinkAllAB = function (map, turn_player, depth, a, b, nearwin, evalparam) {\r\n        var best_score = turn_player * 9999999 * -1;\r\n        var besthand;\r\n        if (depth === 0) {\r\n            best_score = Aijs.evalMap(map, nearwin, evalparam);\r\n            return [besthand, best_score];\r\n        }\r\n        if (a === void 0 || b === void 0) {\r\n            a = 9999999 * turn_player * -1;\r\n            b = 9999999 * turn_player;\r\n        }\r\n        var nodeList = Aijs.getNodeMap(map, turn_player);\r\n        for (var i = 0; i < nodeList.length; i++) {\r\n            var hand = nodeList[i][0];\r\n            var map0 = nodeList[i][1];\r\n            var sc = 0;\r\n            // 必勝            \r\n            var end = Aijs.isEndX(map0, nearwin);\r\n            if (end === turn_player) {\r\n                return [hand, 999999 * turn_player];\r\n            }\r\n            // 必敗\r\n            if (end === turn_player * -1) {\r\n                if (besthand === void 0) {\r\n                    best_score = 999999 * turn_player * -1;\r\n                    besthand = hand;\r\n                }\r\n                continue;\r\n            }\r\n            if (Aijs.isNoneNode(map0)) {\r\n                sc = 0;\r\n            }\r\n            else {\r\n                sc = Aijs.deepThinkAllAB(map0, turn_player * -1, depth - 1, b, a, nearwin, evalparam)[1];\r\n            }\r\n            if (besthand === void 0) {\r\n                best_score = sc;\r\n                besthand = hand;\r\n            }\r\n            if (turn_player === 1 && sc > best_score) {\r\n                best_score = sc;\r\n                besthand = hand;\r\n            }\r\n            else if (turn_player === -1 && sc < best_score) {\r\n                best_score = sc;\r\n                besthand = hand;\r\n            }\r\n            if (turn_player === 1 && a < best_score || turn_player === -1 && a > best_score) {\r\n                a = best_score;\r\n            }\r\n            if (turn_player === 1 && b <= best_score || turn_player === -1 && b >= best_score) {\r\n                break;\r\n            }\r\n        }\r\n        return [besthand, best_score];\r\n    };\r\n    /**\r\n     * 考える\r\n     */\r\n    Aijs.thinkAI = function (map, turn_player, depth, a, b, evalparam) {\r\n        var nearwin = false;\r\n        var hand = [undefined, 0];\r\n        var wkMap = new Int8Array(map);\r\n        if (!evalparam) {\r\n            evalparam = Aijs.DEFAULT_EVALPARAM;\r\n        }\r\n        if (Aijs.isEndX(wkMap, false) !== 0) {\r\n            nearwin = true;\r\n        }\r\n        hand = Aijs.deepThinkAllAB(wkMap, turn_player, depth, a, b, nearwin, evalparam);\r\n        if (hand[1] * turn_player === -999999) {\r\n            hand = Aijs.deepThinkAllAB(wkMap, turn_player, 1, a, b, nearwin, evalparam);\r\n        }\r\n        return hand;\r\n    };\r\n    /**\r\n     * 駒の進める方向\r\n     * @const\r\n     * @type {Array.<Array.<number>>}\r\n     * index+8:コマの数字\r\n     */\r\n    Aijs.PIECES = [\r\n        [0, 0, 0,\r\n            0, 0, 0,\r\n            0, 1, 0],\r\n        [0, 1, 0,\r\n            0, 0, 0,\r\n            0, 1, 0],\r\n        [0, 1, 0,\r\n            0, 0, 0,\r\n            1, 0, 1],\r\n        [1, 0, 1,\r\n            0, 0, 0,\r\n            1, 0, 1],\r\n        [1, 0, 1,\r\n            0, 0, 0,\r\n            1, 1, 1],\r\n        [1, 1, 1,\r\n            0, 0, 0,\r\n            1, 1, 1],\r\n        [1, 0, 1,\r\n            1, 0, 1,\r\n            1, 1, 1],\r\n        [1, 1, 1,\r\n            1, 0, 1,\r\n            1, 1, 1],\r\n        [0, 0, 0,\r\n            0, 0, 0,\r\n            0, 0, 0],\r\n        [1, 1, 1,\r\n            1, 0, 1,\r\n            1, 1, 1],\r\n        [1, 1, 1,\r\n            1, 0, 1,\r\n            1, 0, 1],\r\n        [1, 1, 1,\r\n            0, 0, 0,\r\n            1, 1, 1],\r\n        [1, 1, 1,\r\n            0, 0, 0,\r\n            1, 0, 1],\r\n        [1, 0, 1,\r\n            0, 0, 0,\r\n            1, 0, 1],\r\n        [1, 0, 1,\r\n            0, 0, 0,\r\n            0, 1, 0],\r\n        [0, 1, 0,\r\n            0, 0, 0,\r\n            0, 1, 0],\r\n        [0, 1, 0,\r\n            0, 0, 0,\r\n            0, 0, 0]\r\n    ];\r\n    /**\r\n     * 盤の番号\r\n     * @const\r\n     * @type {Array.<number>}\r\n     */\r\n    Aijs.NUMBERS = [0, 1, 2, 3, 4, 5,\r\n        10, 11, 12, 13, 14, 15,\r\n        20, 21, 22, 23, 24, 25,\r\n        30, 31, 32, 33, 34, 35,\r\n        40, 41, 42, 43, 44, 45,\r\n        50, 51, 52, 53, 54, 55];\r\n    /**\r\n     * 初期評価関数\r\n     * @const\r\n     * @type {Object.<number, Array.<number>>}\r\n     */\r\n    Aijs.DEFAULT_EVALPARAM = [\r\n        [],\r\n        [1800, 1850, 1900, 1950, 2100, 2800],\r\n        [1800, 1860, 1920, 2100, 2400, 3800],\r\n        [1450, 1520, 1590, 1900, 2350, 4450],\r\n        [1450, 1530, 1610, 2050, 2650, 5450],\r\n        [1350, 1440, 1530, 2100, 2850, 6350],\r\n        [1350, 1450, 1550, 2250, 3150, 7350],\r\n        [1250, 1360, 1470, 2300, 3350, 8250],\r\n        [1250, 1370, 1490, 2450, 4350, 11250] //8\r\n    ];\r\n    return Aijs;\r\n}());\r\nexport { Aijs };\r\n","/* @license Copyright (c) @kurehajime / source code: https://github.com/kurehajime/colamone_js */\r\nimport { Aijs } from \"./ai\";\r\n// Class ------------------------------------------------\r\nvar BoardGamejs = /** @class */ (function () {\r\n    function BoardGamejs() {\r\n        var _this = this;\r\n        // Body ---------------------------------------\r\n        this.ctx = null;\r\n        this.isTouch = true;\r\n        this.goaled = false;\r\n        this.canv_board = null;\r\n        this.canv_board2 = null;\r\n        this.canv_focus = null;\r\n        this.canv_pieces = null;\r\n        this.canv_shadow = null;\r\n        this.canv_hover_piece = null;\r\n        this.canv_overlay = null;\r\n        this.canv_bk = null;\r\n        this.canv_cover = null;\r\n        this.canv_score = null;\r\n        this.canv_cache = null;\r\n        this.cache_on = false;\r\n        this.img_bk_loaded = false;\r\n        this.hover_piece = null;\r\n        this.cellSize = 0;\r\n        this.turn_player = 0;\r\n        this.blueScore = 0;\r\n        this.redScore = 0;\r\n        this.winner = null;\r\n        this.message = '';\r\n        this.thinktime = 0.0;\r\n        this.demo = true;\r\n        this.autoLog = false;\r\n        this.intervalID = null;\r\n        this.intervalID_log = null;\r\n        this.thisHand = undefined;\r\n        this.demo_inc = 0;\r\n        this.COLOR_LINE = '#333333';\r\n        this.COLOR_PANEL_1 = '#660033';\r\n        this.COLOR_PANEL_2 = '#004466';\r\n        this.COLOR_PANEL_3 = '#FFFFFF';\r\n        this.COLOR_PANEL_4 = '#111111';\r\n        this.COLOR_PANEL_5 = '#444444';\r\n        this.COLOR_PANEL_6 = '#888888';\r\n        this.COLOR_SELECT = '#7fed7f';\r\n        this.COLOR_SELECT2 = '#148d14';\r\n        this.COLOR_RED = '#E60073';\r\n        this.COLOR_BLUE = '#0099E6';\r\n        this.COLOR_RED2 = '#E60073';\r\n        this.COLOR_BLUE2 = '#0099E6';\r\n        this.COLOR_WHITE = '#FFFFFF';\r\n        this.RATIO = 1;\r\n        this.CANV_SIZE = 0;\r\n        this.PIECES = {\r\n            '1': [1, 1, 1,\r\n                1, 0, 1,\r\n                1, 1, 1],\r\n            '2': [1, 1, 1,\r\n                1, 0, 1,\r\n                1, 0, 1],\r\n            '3': [1, 1, 1,\r\n                0, 0, 0,\r\n                1, 1, 1],\r\n            '4': [1, 1, 1,\r\n                0, 0, 0,\r\n                1, 0, 1],\r\n            '5': [1, 0, 1,\r\n                0, 0, 0,\r\n                1, 0, 1],\r\n            '6': [1, 0, 1,\r\n                0, 0, 0,\r\n                0, 1, 0],\r\n            '7': [0, 1, 0,\r\n                0, 0, 0,\r\n                0, 1, 0],\r\n            '8': [0, 1, 0,\r\n                0, 0, 0,\r\n                0, 0, 0],\r\n            '-1': [1, 1, 1,\r\n                1, 0, 1,\r\n                1, 1, 1],\r\n            '-2': [1, 0, 1,\r\n                1, 0, 1,\r\n                1, 1, 1],\r\n            '-3': [1, 1, 1,\r\n                0, 0, 0,\r\n                1, 1, 1],\r\n            '-4': [1, 0, 1,\r\n                0, 0, 0,\r\n                1, 1, 1],\r\n            '-5': [1, 0, 1,\r\n                0, 0, 0,\r\n                1, 0, 1],\r\n            '-6': [0, 1, 0,\r\n                0, 0, 0,\r\n                1, 0, 1],\r\n            '-7': [0, 1, 0,\r\n                0, 0, 0,\r\n                0, 1, 0],\r\n            '-8': [0, 0, 0,\r\n                0, 0, 0,\r\n                0, 1, 0]\r\n        };\r\n        /*  let thisMap = {\r\n            0: -1, 10: -2, 20: -3, 30: -4, 40: -5, 50: -6,\r\n            1: 0, 11: -8, 21: 0, 31: 0, 41: -7, 51: 0,\r\n            2: 0, 12: 0, 22: 0, 32: 0, 42: 0, 52: 0,\r\n            3: 0, 13: 0, 23: 0, 33: 0, 43: 0, 53: 0,\r\n            4: 0, 14: 7, 24: 0, 34: 0, 44: 8, 54: 0,\r\n            5: 6, 15: 5, 25: 4, 35: 3, 45: 2, 55: 1\r\n          };*/\r\n        this.thisMap = new Int8Array([\r\n            -1, 0, 0, 0, 0, 6, 0, 0, 0, 0, -2, -8,\r\n            0, 0, 7, 5, 0, 0, 0, 0, -3, 0, 0, 0,\r\n            0, 4, 0, 0, 0, 0, -4, 0, 0, 0, 0,\r\n            3, 0, 0, 0, 0, -5, -7, 0, 0, 8, 2,\r\n            0, 0, 0, 0, -6, 0, 0, 0, 0, 1\r\n        ]);\r\n        this.map_list = {};\r\n        this.LIMIT_1000DAY = 3;\r\n        this.mouse_x = 0;\r\n        this.mouse_y = 0;\r\n        this.startMap = new Int8Array();\r\n        this.logPointer = 0;\r\n        this.logArray = [];\r\n        this.logArray2 = [];\r\n        this.img_bk = null;\r\n        this.storage = null;\r\n        /**\r\n         * マウス移動時処理\r\n         */\r\n        this.ev_mouseMove = function (e) {\r\n            _this.getMousePosition(e);\r\n            _this.flush(false, true);\r\n        };\r\n        /**\r\n         * タッチ移動時処理\r\n         */\r\n        this.ev_touchMove = function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        };\r\n        /**\r\n         * マウスクリック時処理\r\n         */\r\n        this.ev_mouseClick = function (e) {\r\n            _this.getMousePosition(e);\r\n            var target = Math.floor(_this.mouse_x / _this.cellSize) * 10 + Math.floor(_this.mouse_y / _this.cellSize);\r\n            if (_this.winner !== null || _this.logArray.length !== 0) {\r\n                _this.reloadnew();\r\n                return true;\r\n            }\r\n            if (_this.demo === true) {\r\n                _this.demo = false;\r\n                _this.thisHand = undefined;\r\n                _this.thisMap = Aijs.copyMap(_this.startMap);\r\n                _this.logArray2 = [];\r\n                _this.flush(false, false);\r\n                _this.winner = null;\r\n                _this.goaled = false;\r\n                _this.turn_player = 1;\r\n                window.clearInterval(_this.intervalID);\r\n                _this.flush(false, false);\r\n                return true;\r\n            }\r\n            if (_this.hover_piece === null) {\r\n                if (_this.thisMap[target] * _this.turn_player > 0) {\r\n                    _this.hover_piece = target;\r\n                }\r\n            }\r\n            else {\r\n                if (target == _this.hover_piece) {\r\n                    _this.hover_piece = null;\r\n                    _this.flush(false, false);\r\n                    return true;\r\n                }\r\n                var canm = Aijs.getCanMovePanelX(_this.hover_piece, _this.thisMap);\r\n                if (canm.indexOf(target) >= 0) {\r\n                    _this.flush(false, true);\r\n                    if (_this.isGoaled(_this.thisMap, target, _this.turn_player)) {\r\n                        _this.goaled = true;\r\n                        _this.flush(false, true);\r\n                        setTimeout(function () {\r\n                            _this.goaled = false;\r\n                            _this.flush(false, false);\r\n                        }, 2000);\r\n                    }\r\n                    _this.thisMap[target] = _this.thisMap[_this.hover_piece];\r\n                    _this.thisMap[_this.hover_piece] = 0;\r\n                    _this.turn_player = _this.turn_player * -1;\r\n                    _this.logArray2.push([_this.hover_piece, target]);\r\n                    _this.thisHand = [_this.hover_piece, target];\r\n                    _this.hover_piece = null;\r\n                    // AIが考える。\r\n                    _this.message = 'thinking...';\r\n                    window.setTimeout(function () {\r\n                        _this.flush(false, false);\r\n                    }, 50);\r\n                    _this.updateMessage();\r\n                    if (_this.winner === null) {\r\n                        window.setTimeout(function () {\r\n                            _this.ai(parseInt(document.querySelector('#level').value));\r\n                            _this.message = '';\r\n                            _this.updateMessage();\r\n                            _this.flush(false, false);\r\n                        }, 250);\r\n                    }\r\n                }\r\n            }\r\n            _this.flush(false, false);\r\n            return true;\r\n        };\r\n        /**\r\n         * ラジオボタン変更時処理\r\n         */\r\n        this.ev_radioChange = function () {\r\n            var num = document.querySelector('#level').value;\r\n            _this.storage.setItem('level_save', num);\r\n            if (_this.storage.getItem('level_' + num) > 0) {\r\n                document.querySelector('#wins').innerHTML = _this.storage.getItem('level_' + num) + ' win!';\r\n            }\r\n            else {\r\n                document.querySelector('#wins').innerHTML = '';\r\n            }\r\n            _this.thisMap = Aijs.copyMap(_this.startMap);\r\n            _this.thisHand = undefined;\r\n            _this.map_list = {};\r\n            _this.logArray2 = [];\r\n            _this.flush(false, false);\r\n        };\r\n        if (window.devicePixelRatio !== undefined && window.devicePixelRatio != 1) {\r\n            this.RATIO = window.devicePixelRatio;\r\n        }\r\n        this.CANV_SIZE = 500 * this.RATIO;\r\n        this.img_bk = new Image();\r\n        this.img_bk.src = 'bk.gif';\r\n        try {\r\n            if (window == parent && ('localStorage' in window) && window.localStorage !== null) {\r\n                this.storage = localStorage;\r\n                this.storage.setItem('test', 0); // Safariのプライベートモードは、できないのにできるって言うからかまをかけてみる。\r\n            }\r\n        }\r\n        catch (e) {\r\n            this.storage = null;\r\n        }\r\n        if (this.storage === null) {\r\n            // localStorageが使えない場合\r\n            this.storage = {}; // ダミー\r\n            this.storage.getItem = function () { return undefined; };\r\n            this.storage.setItem = function () { return undefined; };\r\n            if (navigator.cookieEnabled) {\r\n                this.storage.hasItem = function (sKey) {\r\n                    return (new RegExp('(?:^|;\\\\s*)' + escape(sKey).replace(/[\\-\\.\\+\\*]/g, '\\\\$&') + '\\\\s*\\\\=')).test(document.cookie);\r\n                };\r\n                this.storage.getItem = function (sKey) {\r\n                    if (!sKey || !(new RegExp('(?:^|;\\\\s*)' + escape(sKey).replace(/[\\-\\.\\+\\*]/g, '\\\\$&') + '\\\\s*\\\\=')).test(document.cookie)) {\r\n                        return null;\r\n                    }\r\n                    return unescape(document.cookie.replace(new RegExp('(?:^|.*;\\\\s*)' + escape(sKey).replace(/[\\-\\.\\+\\*]/g, '\\\\$&') + '\\\\s*\\\\=\\\\s*((?:[^;](?!;))*[^;]?).*'), '$1'));\r\n                };\r\n                this.storage.setItem = function (sKey, sValue) {\r\n                    if (!sKey || /^(?:expires|max\\-age|path|domain|secure)$/i.test(sKey)) {\r\n                        return;\r\n                    }\r\n                    document.cookie = escape(sKey) + '=' + escape(sValue);\r\n                };\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * ゲーム開始\r\n     */\r\n    BoardGamejs.prototype.Run = function () {\r\n        var _this = this;\r\n        var _a, _b, _c;\r\n        this.zoom(); // 小さい端末でズーム\r\n        if (window.innerHeight < window.innerWidth) {\r\n            (_a = document.querySelector('.manual')) === null || _a === void 0 ? void 0 : _a.classList.remove(\"hide\");\r\n        }\r\n        else {\r\n            (_b = document.querySelector('.manual')) === null || _b === void 0 ? void 0 : _b.classList.add(\"hide\");\r\n        }\r\n        this.ctx = (_c = document.querySelector('#canv')) === null || _c === void 0 ? void 0 : _c.getContext('2d');\r\n        this.canv_board = document.createElement('canvas');\r\n        this.canv_board.width = this.CANV_SIZE;\r\n        this.canv_board.height = this.CANV_SIZE;\r\n        this.canv_board2 = document.createElement('canvas');\r\n        this.canv_board2.width = this.CANV_SIZE;\r\n        this.canv_board2.height = this.CANV_SIZE;\r\n        this.canv_focus = document.createElement('canvas');\r\n        this.canv_focus.width = this.CANV_SIZE;\r\n        this.canv_focus.height = this.CANV_SIZE;\r\n        this.canv_pieces = document.createElement('canvas');\r\n        this.canv_pieces.width = this.CANV_SIZE;\r\n        this.canv_pieces.height = this.CANV_SIZE;\r\n        this.canv_shadow = document.createElement('canvas');\r\n        this.canv_shadow.width = this.CANV_SIZE;\r\n        this.canv_shadow.height = this.CANV_SIZE;\r\n        this.canv_hover_piece = document.createElement('canvas');\r\n        this.canv_hover_piece.width = this.CANV_SIZE;\r\n        this.canv_hover_piece.height = this.CANV_SIZE;\r\n        this.canv_overlay = document.createElement('canvas');\r\n        this.canv_overlay.width = this.CANV_SIZE;\r\n        this.canv_overlay.height = this.CANV_SIZE;\r\n        this.canv_bk = document.createElement('canvas');\r\n        this.canv_bk.width = this.CANV_SIZE;\r\n        this.canv_bk.height = this.CANV_SIZE;\r\n        this.canv_cover = document.createElement('canvas');\r\n        this.canv_cover.width = this.CANV_SIZE;\r\n        this.canv_cover.height = this.CANV_SIZE;\r\n        this.canv_score = document.createElement('canvas');\r\n        this.canv_score.width = this.CANV_SIZE;\r\n        this.canv_score.height = this.CANV_SIZE;\r\n        this.canv_cache = document.createElement('canvas');\r\n        this.canv_cache.width = this.CANV_SIZE;\r\n        this.canv_cache.height = this.CANV_SIZE;\r\n        this.cellSize = this.CANV_SIZE / 6;\r\n        this.turn_player = 1;\r\n        this.demo = true;\r\n        //retina対応\r\n        this.ctx.canvas.style.width = this.CANV_SIZE / this.RATIO + \"px\";\r\n        this.ctx.canvas.style.height = this.CANV_SIZE / this.RATIO + \"px\";\r\n        this.ctx.canvas.width = this.CANV_SIZE;\r\n        this.ctx.canvas.height = this.CANV_SIZE;\r\n        if ('ontouchstart' in window) {\r\n            this.isTouch = true;\r\n        }\r\n        else {\r\n            this.isTouch = false;\r\n        }\r\n        // イベントを設定\r\n        if (this.isTouch) {\r\n            document.querySelector('#canv').addEventListener('touchstart', this.ev_mouseClick);\r\n            document.querySelector('#canv').addEventListener('touchmove', this.ev_touchMove, { passive: false });\r\n        }\r\n        else {\r\n            document.querySelector('#canv').addEventListener('mousemove', this.ev_mouseMove);\r\n            document.querySelector('#canv').addEventListener('mouseup', this.ev_mouseClick);\r\n        }\r\n        document.querySelector('#level').addEventListener('change', this.ev_radioChange);\r\n        document.querySelector('#prevprev').addEventListener('click', function () { _this.move_start(); });\r\n        document.querySelector('#prev').addEventListener('click', function () { _this.move_prev(); });\r\n        document.querySelector('#next').addEventListener('click', function () { _this.move_next(); });\r\n        document.querySelector('#nextnext').addEventListener('click', function () { _this.move_end(); });\r\n        document.querySelector('#replay').addEventListener('click', function () { _this.jumpkento(); });\r\n        document.querySelector('#tweetlog').addEventListener('click', function () { _this.tweetlog(); });\r\n        document.querySelector('#newgame').addEventListener('click', function () { _this.reloadnew(); });\r\n        document.querySelector('#collapsible').addEventListener('click', function () {\r\n            document.querySelector('.manual').classList.toggle(\"hide\");\r\n            if (window.innerHeight > window.innerWidth) {\r\n                var element = document.documentElement;\r\n                var bottom = element.scrollHeight - element.clientHeight;\r\n                window.scroll(0, bottom);\r\n            }\r\n        });\r\n        window.addEventListener('orientationchange', this.zoom);\r\n        this.shuffleBoard();\r\n        // 連勝記録初期化\r\n        if (!this.storage.getItem('level_1')) {\r\n            this.storage.setItem('level_1', 0);\r\n        }\r\n        if (!this.storage.getItem('level_2')) {\r\n            this.storage.setItem('level_2', 0);\r\n        }\r\n        if (!this.storage.getItem('level_3')) {\r\n            this.storage.setItem('level_3', 0);\r\n        }\r\n        if (!this.storage.getItem('level_4')) {\r\n            this.storage.setItem('level_4', 0);\r\n        }\r\n        if (!this.storage.getItem('level_5')) {\r\n            this.storage.setItem('level_5', 0);\r\n        }\r\n        // レベル記憶\r\n        if (this.storage.getItem('level_save') !== undefined && this.storage.getItem('level_save') !== 'undefined' && this.storage.getItem('level_save') !== null) {\r\n            document.querySelector('#level').value = String(parseInt(this.storage.getItem('level_save')));\r\n        }\r\n        else {\r\n            this.storage.setItem('level_save', 1);\r\n            document.querySelector('#level').value = String(1);\r\n        }\r\n        //document.querySelector('#canv').classList.add(\"hue-rotate1\");\r\n        // パラメータを取得\r\n        var paramObj = this.getParam();\r\n        // 盤面を初期化\r\n        if (paramObj.init) {\r\n            this.startMap = this.getMapByParam(paramObj.init);\r\n            this.thisMap = Aijs.copyMap(this.startMap);\r\n        }\r\n        else {\r\n            this.startMap = Aijs.copyMap(this.thisMap);\r\n        }\r\n        // ログをデコード\r\n        if (paramObj.log) {\r\n            this.logArray = this.decodeLog(paramObj.log, this.startMap);\r\n        }\r\n        // レベル取得\r\n        if (paramObj.lv) {\r\n            document.querySelector('#level').value = String(parseInt(paramObj.lv));\r\n        }\r\n        if (this.logArray.length !== 0) {\r\n            document.querySelector('#log').classList.remove(\"hide\");\r\n            document.querySelector('#prevprev').classList.remove(\"hide\");\r\n            document.querySelector('#prev').classList.remove(\"hide\");\r\n            document.querySelector('#next').classList.remove(\"hide\");\r\n            document.querySelector('#nextnext').classList.remove(\"hide\");\r\n            document.querySelector('#span_replay').classList.add(\"hide\");\r\n            document.querySelector('#span_tweetlog').classList.add(\"hide\");\r\n            document.querySelector('#next').focus();\r\n        }\r\n        else {\r\n            document.querySelector('#log').classList.add(\"hide\");\r\n            document.querySelector('#prevprev').classList.add(\"hide\");\r\n            document.querySelector('#prev').classList.add(\"hide\");\r\n            document.querySelector('#next').classList.add(\"hide\");\r\n            document.querySelector('#nextnext').classList.add(\"hide\");\r\n            document.querySelector('#span_replay').classList.add(\"hide\");\r\n            document.querySelector('#span_tweetlog').classList.add(\"hide\");\r\n        }\r\n        // 画像読み込み成功時\r\n        this.img_bk.onload = function () {\r\n            _this.img_bk_loaded = true;\r\n            _this.flush(true, false);\r\n        };\r\n        // 画像読み込み失敗時\r\n        this.img_bk.onerror = function () {\r\n            _this.flush(true, false);\r\n        };\r\n        // もう既に読み込み終わってた時\r\n        if (this.img_bk.width !== 0) {\r\n            this.img_bk_loaded = true;\r\n            this.flush(true, false);\r\n        }\r\n        // 2.5秒後に強制描画※Googleの検索結果から飛ぶとなぜか描画が走らない事があるので。\r\n        setTimeout(function () {\r\n            if (_this.img_bk.width !== 0) {\r\n                _this.img_bk_loaded = true;\r\n            }\r\n            _this.flush(true, false);\r\n        }, 2500);\r\n        this.updateMessage();\r\n        this.setTweet(); // ツイートボタンを生成\r\n        if (this.logArray.length === 0) {\r\n            if (this.isBot() == false) {\r\n                window.setTimeout(function () {\r\n                    if (_this.demo == true) {\r\n                        _this.intervalID = window.setInterval(function () { _this.playDemo(); }, 400);\r\n                        _this.playDemo();\r\n                    }\r\n                }, 500);\r\n            }\r\n        }\r\n        else {\r\n            this.demo = false;\r\n            this.autoLog = true;\r\n            this.intervalID_log = window.setInterval(function () { _this.playLog(); }, 1000);\r\n        }\r\n        this.goaled = false;\r\n        this.flush(true, false);\r\n    };\r\n    /**\r\n     * Demoを再生\r\n     */\r\n    BoardGamejs.prototype.playDemo = function () {\r\n        if (this.intervalID !== null) {\r\n            if (Math.random() > 0.3) {\r\n                this.ai(2);\r\n            }\r\n            else {\r\n                this.ai(1);\r\n            }\r\n        }\r\n        this.demo_inc++;\r\n        this.calcScore();\r\n        this.flush(false, false);\r\n        if (this.winner === 1 || this.winner === -1 || this.winner === 0) {\r\n            this.goaled = true;\r\n            this.winner = null;\r\n            this.flush(false, false);\r\n            this.shuffleBoard();\r\n        }\r\n        if (this.demo_inc > 42) {\r\n            window.clearInterval(this.intervalID);\r\n        }\r\n    };\r\n    /**\r\n     * Logを再生\r\n     */\r\n    BoardGamejs.prototype.playLog = function () {\r\n        if (this.intervalID_log !== null && this.autoLog == true) {\r\n            this.move_next();\r\n        }\r\n        else {\r\n            clearInterval(this.intervalID_log);\r\n        }\r\n    };\r\n    /**\r\n     * 小さい画面ではViewportを固定化\r\n     */\r\n    BoardGamejs.prototype.zoom = function () {\r\n        var viewport = document.querySelector('meta[name=viewport]');\r\n        if (screen.width < 500 && screen.height < 500) {\r\n            if (screen.width < screen.height) {\r\n                viewport.setAttribute('content', 'width=500,user-scalable=no');\r\n            }\r\n            else {\r\n                viewport.setAttribute('content', 'height=500,user-scalable=no');\r\n            }\r\n        }\r\n        else if (screen.width < 500) {\r\n            viewport.setAttribute('content', 'width=500,user-scalable=no');\r\n        }\r\n        else if (screen.height < 500) {\r\n            viewport.setAttribute('content', 'height=500,user-scalable=no');\r\n        }\r\n        // iOS9のViewportはなぜか機能してくれない。\r\n        if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {\r\n            var w = screen.width;\r\n            var w2 = 520;\r\n            if (Math.abs(window.orientation) !== 0) {\r\n                w = screen.height;\r\n                w2 = 900;\r\n            }\r\n            var rate = Math.round((w / w2) * 1000) / 1000.0;\r\n            if (rate == Math.round(rate)) { // iOS 9のViewportは整数指定すると機能しない\r\n                rate += 0.0001;\r\n            }\r\n            viewport.setAttribute('content', 'initial-scale=' + rate + ', minimum-scale=' + rate + ', maximum-scale=' + rate + ', user-scalable=no');\r\n        }\r\n    };\r\n    /**\r\n     * AIに考えてもらう。\r\n     */\r\n    BoardGamejs.prototype.ai = function (level) {\r\n        var _this = this;\r\n        var hand;\r\n        var startTime = new Date();\r\n        var endTime;\r\n        // 終盤になったら長考してみる。\r\n        var count = this.getNodeCount(this.thisMap) / 2;\r\n        var plus = 0;\r\n        switch (level) {\r\n            case 1:\r\n                if (count <= 7) {\r\n                    plus++;\r\n                }\r\n                break;\r\n            case 2:\r\n                if (count <= 8) {\r\n                    plus++;\r\n                }\r\n                break;\r\n            case 3:\r\n                if (count <= 10) {\r\n                    plus++;\r\n                }\r\n                if (count <= 6) {\r\n                    plus++;\r\n                }\r\n                break;\r\n            case 4:\r\n                if (count <= 11) {\r\n                    plus++;\r\n                }\r\n                if (count <= 7) {\r\n                    plus++;\r\n                }\r\n                break;\r\n            case 5:\r\n                if (count > 16) {\r\n                    plus--;\r\n                }\r\n                if (count <= 12) {\r\n                    plus++;\r\n                }\r\n                if (count <= 8) {\r\n                    plus++;\r\n                }\r\n                break;\r\n            case 6:\r\n                if (count > 16) {\r\n                    plus--;\r\n                }\r\n                if (count <= 12) {\r\n                    plus++;\r\n                }\r\n                if (count <= 8) {\r\n                    plus++;\r\n                }\r\n                break;\r\n        }\r\n        hand = Aijs.thinkAI(this.thisMap, this.turn_player, level + plus + 1, undefined, undefined, undefined)[0];\r\n        this.thisHand = hand;\r\n        if (hand) {\r\n            if (this.isGoaled(this.thisMap, hand[1], this.turn_player)) {\r\n                this.goaled = true;\r\n                this.flush(false, true);\r\n                setTimeout(function () {\r\n                    _this.goaled = false;\r\n                    _this.flush(false, false);\r\n                }, 2000);\r\n            }\r\n            this.thisMap[hand[1]] = this.thisMap[hand[0]];\r\n            this.thisMap[hand[0]] = 0;\r\n            this.logArray2.push([hand[0], hand[1]]);\r\n            // //フォーカス座標を移す。\r\n            // mouse_x = Math.floor(hand[1] / 10)*cellSize+1\r\n            // mouse_y = Math.floor(hand[1] % 10)*cellSize+1\r\n        }\r\n        this.turn_player = this.turn_player * -1;\r\n        endTime = new Date();\r\n        this.thinktime = (endTime.getTime() - startTime.getTime()) / 1000;\r\n    };\r\n    /**\r\n     * ゴールしたか\r\n     */\r\n    BoardGamejs.prototype.isGoaled = function (map, afterHand, turn) {\r\n        if (turn > 0) {\r\n            if (afterHand % 10 === 0) {\r\n                return true;\r\n            }\r\n        }\r\n        else if (turn < 0) {\r\n            if (afterHand % 10 === 5) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    /**\r\n     * 盤面をシャッフル。\r\n     */\r\n    BoardGamejs.prototype.shuffleBoard = function () {\r\n        // クリア\r\n        for (var num in this.thisMap) {\r\n            this.thisMap[num] = 0;\r\n        }\r\n        var arr = [1, 2, 3, 4, 5, 6, 7, 8];\r\n        var red_num = [0, 10, 20, 30, 40, 50, 11, 41];\r\n        var blue_num = [55, 45, 35, 25, 15, 5, 44, 14];\r\n        for (var i = arr.length - 1; i >= 0; i--) {\r\n            var r = Math.floor(Math.random() * (i + 1));\r\n            var tmp = arr[i];\r\n            arr[i] = arr[r];\r\n            arr[r] = tmp;\r\n        }\r\n        for (var num in blue_num) {\r\n            this.thisMap[blue_num[num]] = arr[num];\r\n        }\r\n        for (var num in red_num) {\r\n            this.thisMap[red_num[num]] = -1 * arr[num];\r\n        }\r\n    };\r\n    /**\r\n     * マウス位置取得\r\n     */\r\n    BoardGamejs.prototype.getMousePosition = function (e) {\r\n        var _a;\r\n        if (e == null) {\r\n            return;\r\n        }\r\n        if (!e.clientX) { // SmartPhone\r\n            if (e.touches) {\r\n                e = e.touches[0];\r\n            }\r\n            else if (e.touches) {\r\n                e = e.touches[0];\r\n            }\r\n            else {\r\n                e = (_a = event) === null || _a === void 0 ? void 0 : _a.touches[0];\r\n            }\r\n        }\r\n        var rect = e.target.getBoundingClientRect();\r\n        this.mouse_x = e.clientX - rect.left;\r\n        this.mouse_y = e.clientY - rect.top;\r\n        this.mouse_x = this.mouse_x * this.RATIO;\r\n        this.mouse_y = this.mouse_y * this.RATIO;\r\n    };\r\n    /**\r\n     * 画面描画。\r\n     */\r\n    BoardGamejs.prototype.flush = function (initflg, cache_flg) {\r\n        var wkMap = new Int8Array(this.thisMap);\r\n        this.ctx.clearRect(0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        if (cache_flg === false) {\r\n            this.cache_on = false;\r\n        }\r\n        // キャッシュに保存\r\n        if (cache_flg === false || this.cache_on === false) {\r\n            // 盤面を描画\r\n            this.ctx.drawImage(this.drawBoard(initflg), 0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n            // テカリを描画\r\n            this.ctx.drawImage(this.drawBoard2(initflg), 0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n            // 選択したコマを除外\r\n            if (this.hover_piece !== null) {\r\n                wkMap[this.hover_piece] = 0;\r\n            }\r\n            // 残像を表示\r\n            this.ctx.drawImage(this.drawShadow(wkMap, this.thisHand), 0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n            // コマを表示\r\n            this.ctx.drawImage(this.drawPieceAll(wkMap), 0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n            // キャッシュに保存\r\n            var ctx_canv = this.canv_cache.getContext('2d');\r\n            ctx_canv.clearRect(0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n            ctx_canv.drawImage(this.ctx.canvas, 0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n            // キャッシュ有効化\r\n            this.cache_on = true;\r\n        }\r\n        else {\r\n            // キャッシュから描画\r\n            this.ctx.drawImage(this.canv_cache, 0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        }\r\n        // 選択したコマを表示\r\n        this.ctx.drawImage(this.drawHoverPiece(), 0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        if ((this.mouse_x !== 0 || this.mouse_y !== 0) && this.demo === false) {\r\n            // フォーカスを描画\r\n            this.ctx.drawImage(this.drawFocus(), 0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        }\r\n        //スコアを表示\r\n        if (this.goaled || this.winner !== null) {\r\n            if (this.demo === false && this.autoLog == false) {\r\n                this.ctx.drawImage(this.drawScore(), 0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n            }\r\n        }\r\n        // メッセージを描画\r\n        this.ctx.drawImage(this.drawOverlay(), 0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        // カバーを描画\r\n        if (this.demo === true) {\r\n            this.ctx.drawImage(this.drawCover(), 0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        }\r\n    };\r\n    /**\r\n     * 背景描画\r\n     */\r\n    BoardGamejs.prototype.drawBk = function () {\r\n        var ctx_bk = this.canv_bk.getContext('2d');\r\n        if (this.img_bk_loaded) {\r\n            ctx_bk.drawImage(this.img_bk, 0, 0, this.CANV_SIZE / this.RATIO, this.CANV_SIZE / this.RATIO, 0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        }\r\n        return this.canv_bk;\r\n    };\r\n    /**\r\n     * カバー描画\r\n     */\r\n    BoardGamejs.prototype.drawCover = function () {\r\n        // 背景\r\n        var ctx_cover = this.canv_cover.getContext('2d');\r\n        ctx_cover.clearRect(0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        ctx_cover.globalAlpha = 0.50;\r\n        ctx_cover.fillStyle = '#000000';\r\n        ctx_cover.fillRect(0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        // 枠\r\n        var x = this.cellSize * 2;\r\n        var y = this.cellSize * 3.5;\r\n        ctx_cover.shadowBlur = 20;\r\n        ctx_cover.shadowColor = 'rgba(0, 0, 0, 0.3)';\r\n        ctx_cover.shadowOffsetX = 5;\r\n        ctx_cover.shadowOffsetY = 5;\r\n        ctx_cover.globalAlpha = 0.8;\r\n        ctx_cover.fillStyle = this.COLOR_WHITE;\r\n        ctx_cover.beginPath();\r\n        this.fillRoundRect(ctx_cover, x, y, this.cellSize * 2, this.cellSize * 1, this.cellSize / 20);\r\n        ctx_cover.shadowColor = 'rgba(0, 0, 0, 0)';\r\n        ctx_cover.shadowBlur = 0;\r\n        ctx_cover.shadowOffsetX = 0;\r\n        ctx_cover.shadowOffsetY = 0;\r\n        // 文字\r\n        var fontsize = Math.round(this.cellSize * 0.5);\r\n        var message = 'Play';\r\n        message += (this.demo_inc % 10 == 0) ? \" \" : \"\";\r\n        ctx_cover.shadowBlur = 0;\r\n        ctx_cover.shadowOffsetX = 0;\r\n        ctx_cover.shadowOffsetY = 0;\r\n        ctx_cover.shadowColor = 'rgba(0, 0, 0, 0)';\r\n        ctx_cover.font = 'bold ' + fontsize + 'px Play,sans-serif';\r\n        ctx_cover.globalAlpha = 1;\r\n        ctx_cover.fillStyle = this.COLOR_LINE;\r\n        ctx_cover.textBaseline = 'middle';\r\n        ctx_cover.textAlign = 'center';\r\n        ctx_cover.beginPath();\r\n        ctx_cover.fillText(message, this.cellSize * 3, this.cellSize * 4);\r\n        // 文字２\r\n        message = 'colamone';\r\n        fontsize = Math.round(this.cellSize * 1);\r\n        ctx_cover.font = 'bold ' + fontsize + 'px Play,sans-serif';\r\n        ctx_cover.fillStyle = this.COLOR_WHITE;\r\n        ctx_cover.shadowBlur = 0;\r\n        ctx_cover.beginPath();\r\n        ctx_cover.fillText(message, this.cellSize * 3, this.cellSize * 2);\r\n        return this.canv_cover;\r\n    };\r\n    /**\r\n     * スコア描画\r\n     */\r\n    BoardGamejs.prototype.drawScore = function () {\r\n        // 背景\r\n        var ctx_score = this.canv_score.getContext('2d');\r\n        var message = \"\";\r\n        var fontsize = Math.round(this.cellSize * 1.5);\r\n        var blue = this.COLOR_BLUE2;\r\n        var red = this.COLOR_RED2;\r\n        ctx_score.clearRect(0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        ctx_score.globalAlpha = 0.4;\r\n        ctx_score.textBaseline = 'middle';\r\n        ctx_score.textAlign = 'center';\r\n        ctx_score.shadowBlur = 10;\r\n        ctx_score.shadowColor = 'rgba(0, 0, 0, 0.5)';\r\n        ctx_score.font = 'bold ' + fontsize + 'px Play,sans-serif';\r\n        // 文字\r\n        ctx_score.globalAlpha = 0.3;\r\n        ctx_score.shadowBlur = 2;\r\n        ctx_score.shadowColor = 'rgba(255, 255, 255, 1)';\r\n        ctx_score.fillStyle = red;\r\n        message = String(this.redScore);\r\n        ctx_score.beginPath();\r\n        ctx_score.fillText(message, this.cellSize * 1, this.cellSize * 3.8);\r\n        // 文字\r\n        message = \"8\";\r\n        ctx_score.beginPath();\r\n        ctx_score.fillText(message, this.cellSize * 2, this.cellSize * 5.3);\r\n        //線\r\n        ctx_score.lineWidth = this.cellSize * 0.2;\r\n        ctx_score.strokeStyle = red;\r\n        ctx_score.beginPath();\r\n        ctx_score.moveTo(this.cellSize * 0.4, this.cellSize * 5.55);\r\n        ctx_score.lineTo(this.cellSize * 2.6, this.cellSize * 3.55);\r\n        ctx_score.closePath();\r\n        ctx_score.stroke();\r\n        // 文字\r\n        message = String(this.blueScore);\r\n        ctx_score.fillStyle = blue;\r\n        ctx_score.beginPath();\r\n        ctx_score.fillText(message, this.cellSize * 4, this.cellSize * 0.7);\r\n        // 文字\r\n        message = \"8\";\r\n        ctx_score.beginPath();\r\n        ctx_score.fillText(message, this.cellSize * 5, this.cellSize * 2.3);\r\n        // 文字\r\n        ctx_score.lineWidth = this.cellSize * 0.2;\r\n        ctx_score.strokeStyle = blue;\r\n        ctx_score.beginPath();\r\n        ctx_score.moveTo(this.cellSize * 3.4, this.cellSize * 2.55);\r\n        ctx_score.lineTo(this.cellSize * 5.6, this.cellSize * 0.55);\r\n        ctx_score.closePath();\r\n        ctx_score.stroke();\r\n        return this.canv_score;\r\n    };\r\n    /**\r\n     * フォーカスを描画\r\n     */\r\n    BoardGamejs.prototype.drawFocus = function () {\r\n        // 選択マスを強調\r\n        var x = this.mouse_x - (this.mouse_x % this.cellSize);\r\n        var y = this.mouse_y - (this.mouse_y % this.cellSize);\r\n        var ctx_focus = this.canv_focus.getContext('2d');\r\n        var grad = ctx_focus.createRadialGradient(x, y, 0, x, y, this.cellSize);\r\n        grad.addColorStop(0.3, this.COLOR_SELECT);\r\n        grad.addColorStop(1, this.COLOR_SELECT2);\r\n        ctx_focus.clearRect(0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        ctx_focus.globalAlpha = 0.35;\r\n        ctx_focus.fillStyle = grad;\r\n        ctx_focus.lineWidth = 1;\r\n        ctx_focus.beginPath();\r\n        ctx_focus.fillRect(x, y, this.cellSize, this.cellSize);\r\n        if (this.isTouch === true && this.hover_piece === null) {\r\n            return this.canv_focus;\r\n        }\r\n        // 移動可能マスを強調\r\n        var target = (x / this.cellSize) * 10 + (y / this.cellSize);\r\n        if (this.thisMap[target] * this.turn_player > 0) {\r\n            var canm = Aijs.getCanMovePanelX(target, this.thisMap);\r\n            for (var i = 0; i <= canm.length - 1; i++) {\r\n                x = Math.floor(canm[i] / 10);\r\n                y = Math.floor(canm[i] % 10);\r\n                ctx_focus.globalAlpha = 0.6;\r\n                ctx_focus.strokeStyle = this.COLOR_SELECT;\r\n                ctx_focus.lineWidth = this.cellSize / 20;\r\n                ctx_focus.beginPath();\r\n                ctx_focus.arc(x * this.cellSize + (this.cellSize / 2), y * this.cellSize + (this.cellSize / 2), (this.cellSize / 2) - (this.cellSize / 10), 0, Math.PI * 2, false);\r\n                ctx_focus.stroke();\r\n            }\r\n        }\r\n        return this.canv_focus;\r\n    };\r\n    /**\r\n     * 盤面を描画してCANVASを返す。\r\n     */\r\n    BoardGamejs.prototype.drawBoard = function (initflg) {\r\n        if (initflg === false) {\r\n            return this.canv_board;\r\n        }\r\n        var ctx_board = this.canv_board.getContext('2d');\r\n        ctx_board.clearRect(0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        var grad = ctx_board.createLinearGradient(0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        grad.addColorStop(0, this.COLOR_PANEL_6);\r\n        grad.addColorStop(0.3, this.COLOR_PANEL_5);\r\n        grad.addColorStop(1, this.COLOR_PANEL_4);\r\n        for (var x = 0; x < 6; x++) {\r\n            for (var y = 0; y < 6; y++) {\r\n                // パネル描画\r\n                ctx_board.strokeStyle = this.COLOR_LINE;\r\n                if (y === 0) {\r\n                    ctx_board.fillStyle = this.COLOR_PANEL_1;\r\n                }\r\n                else if (y == 5) {\r\n                    ctx_board.fillStyle = this.COLOR_PANEL_2;\r\n                }\r\n                else if ((x + y) % 2 === 0) {\r\n                    ctx_board.fillStyle = this.COLOR_PANEL_3;\r\n                }\r\n                else {\r\n                    ctx_board.fillStyle = this.COLOR_PANEL_4;\r\n                    ctx_board.fillStyle = grad;\r\n                }\r\n                ctx_board.beginPath();\r\n                ctx_board.fillRect(x * this.cellSize, y * this.cellSize, this.cellSize, this.cellSize);\r\n                ctx_board.strokeRect(x * this.cellSize, y * this.cellSize, this.cellSize, this.cellSize);\r\n            }\r\n        }\r\n        return this.canv_board;\r\n    };\r\n    /**\r\n     * 盤面をテカテカにする。\r\n     */\r\n    BoardGamejs.prototype.drawBoard2 = function (initflg) {\r\n        if (initflg === false) {\r\n            return this.canv_board2;\r\n        }\r\n        var ctx_board2 = this.canv_board2.getContext('2d');\r\n        ctx_board2.clearRect(0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        ctx_board2.globalAlpha = 0.07;\r\n        ctx_board2.fillStyle = this.COLOR_WHITE;\r\n        ctx_board2.beginPath();\r\n        ctx_board2.arc(this.cellSize * 1, -3 * this.cellSize, 7 * this.cellSize, 0, Math.PI * 2, false);\r\n        ctx_board2.fill();\r\n        return this.canv_board2;\r\n    };\r\n    /**\r\n     * 浮遊しているコマを描画する。\r\n     */\r\n    BoardGamejs.prototype.drawHoverPiece = function () {\r\n        var ctx_hover = this.canv_hover_piece.getContext('2d');\r\n        ctx_hover.clearRect(0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        var x = this.mouse_x - (this.cellSize / 2);\r\n        var y = this.mouse_y - (this.cellSize / 2);\r\n        if (this.hover_piece !== null) {\r\n            this.drawPiece(ctx_hover, x, y, this.thisMap[this.hover_piece], false);\r\n        }\r\n        return this.canv_hover_piece;\r\n    };\r\n    /**\r\n     * コマを描画する。\r\n     */\r\n    BoardGamejs.prototype.drawPiece = function (wkCtx, x, y, number, goal) {\r\n        var wkColor;\r\n        // 外枠を描画\r\n        if (number === 0) {\r\n            return wkCtx;\r\n        }\r\n        else if (number > 0) {\r\n            wkColor = this.COLOR_BLUE;\r\n        }\r\n        else {\r\n            wkColor = this.COLOR_RED;\r\n        }\r\n        var grad = this.ctx.createLinearGradient(x, y, x + this.cellSize, y + this.cellSize);\r\n        grad.addColorStop(0, 'rgb(255, 255, 255)');\r\n        grad.addColorStop(0.4, wkColor);\r\n        grad.addColorStop(1, wkColor);\r\n        wkCtx.shadowBlur = 10;\r\n        wkCtx.shadowColor = 'rgba(0, 0, 0, 1)';\r\n        wkCtx.shadowOffsetX = 2;\r\n        wkCtx.shadowOffsetY = 2;\r\n        wkCtx.fillStyle = grad;\r\n        wkCtx.beginPath();\r\n        this.fillRoundRect(wkCtx, x + this.cellSize / 10, y + this.cellSize / 10, this.cellSize - 1 * this.cellSize / 5, this.cellSize - 1 * this.cellSize / 5, this.cellSize / 20);\r\n        wkCtx.shadowColor = 'rgba(0, 0, 0, 0)';\r\n        wkCtx.shadowBlur = 0;\r\n        wkCtx.shadowOffsetX = 0;\r\n        wkCtx.shadowOffsetY = 0;\r\n        // 曇りエフェクト\r\n        if (this.img_bk_loaded) {\r\n            wkCtx.globalAlpha = 0.35;\r\n            wkCtx.save();\r\n            wkCtx.clip();\r\n            wkCtx.drawImage(this.drawBk(), x + this.cellSize / 10, y + this.cellSize / 10, this.cellSize - 1 * this.cellSize / 5, this.cellSize - 1 * this.cellSize / 5);\r\n            wkCtx.restore();\r\n            wkCtx.globalAlpha = 1;\r\n        }\r\n        // 文字を描画。\r\n        wkCtx.fillStyle = this.COLOR_WHITE;\r\n        var fontsize = Math.round(this.cellSize * 0.18);\r\n        wkCtx.textBaseline = 'middle';\r\n        wkCtx.textAlign = 'center';\r\n        wkCtx.font = fontsize + \"pt 'Play',Arial\";\r\n        wkCtx.beginPath();\r\n        // 数字を印字\r\n        wkCtx.fillText(String(Math.abs(number)), x + (this.cellSize / 2), y + (this.cellSize / 2));\r\n        // 点を描画\r\n        for (var i = 0; i <= this.PIECES[number].length - 1; i++) {\r\n            if (this.PIECES[number][i] === 0) {\r\n                continue;\r\n            }\r\n            var x_dot = x + this.cellSize / 4.16 + (Math.floor(this.cellSize - 1 * this.cellSize / 5) / 3) * Math.floor(i % 3.0);\r\n            var y_dot = y + this.cellSize / 4.16 + (Math.floor(this.cellSize - 1 * this.cellSize / 5) / 3) * Math.floor(i / 3.0);\r\n            wkCtx.fillStyle = this.COLOR_WHITE;\r\n            wkCtx.beginPath();\r\n            wkCtx.arc(x_dot, y_dot, this.cellSize * 0.06, 0, Math.PI * 2, false);\r\n            wkCtx.fill();\r\n        }\r\n        if (goal) { // 得点を印字\r\n            wkCtx.shadowBlur = 10;\r\n            wkCtx.shadowColor = 'rgba(0, 0, 0, 1)';\r\n            wkCtx.globalAlpha = 1;\r\n            wkCtx.fillStyle = this.COLOR_WHITE;\r\n            fontsize = Math.round(this.cellSize * 0.5);\r\n            wkCtx.textBaseline = 'middle';\r\n            wkCtx.textAlign = 'center';\r\n            wkCtx.font = 'bolder ' + fontsize + 'pt Play,Arial ';\r\n            wkCtx.beginPath();\r\n            wkCtx.fillText(String(Math.abs(number)), x + (this.cellSize / 2), y + (this.cellSize / 2));\r\n            wkCtx.globalAlpha = 1;\r\n            wkCtx.shadowColor = 'rgba(0, 0, 0, 0)';\r\n            wkCtx.shadowBlur = 0;\r\n        }\r\n        return wkCtx;\r\n    };\r\n    // 角丸\r\n    BoardGamejs.prototype.fillRoundRect = function (ctx, x, y, w, h, r) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(x + r, y);\r\n        ctx.lineTo(x + w - r, y);\r\n        ctx.arc(x + w - r, y + r, r, Math.PI * 1.5, 0, false);\r\n        ctx.lineTo(x + w, y + h - r);\r\n        ctx.arc(x + w - r, y + h - r, r, 0, Math.PI * 0.5, false);\r\n        ctx.lineTo(x + r, y + h);\r\n        ctx.arc(x + r, y + h - r, r, Math.PI * 0.5, Math.PI, false);\r\n        ctx.lineTo(x, y + r);\r\n        ctx.arc(x + r, y + r, r, Math.PI, Math.PI * 1.5, false);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n    };\r\n    /**\r\n     * コマをすべて描画\r\n     */\r\n    BoardGamejs.prototype.drawPieceAll = function (wkMap) {\r\n        var ctx_pieces = this.canv_pieces.getContext('2d');\r\n        ctx_pieces.clearRect(0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        for (var x = 0; x < 6; x++) {\r\n            for (var y = 0; y < 6; y++) {\r\n                if (wkMap[x * 10 + y] !== 0) {\r\n                    var goal = false;\r\n                    if (wkMap[x * 10 + y] > 0 && y === 0) {\r\n                        goal = true;\r\n                    }\r\n                    else if (wkMap[x * 10 + y] < 0 && y == 5) {\r\n                        goal = true;\r\n                    }\r\n                    ctx_pieces = this.drawPiece(ctx_pieces, x * this.cellSize, y * this.cellSize, wkMap[x * 10 + y], goal);\r\n                }\r\n            }\r\n        }\r\n        return this.canv_pieces;\r\n    };\r\n    /**\r\n     * 残像を描画する。\r\n     */\r\n    BoardGamejs.prototype.drawShadow = function (wkMap, hand) {\r\n        var ctx_shadow = this.canv_shadow.getContext('2d');\r\n        ctx_shadow.clearRect(0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        if (hand === undefined) {\r\n            return this.canv_shadow;\r\n        }\r\n        var x0 = (hand[0] / 10 | 0);\r\n        var y0 = hand[0] % 10;\r\n        var x1 = (hand[1] / 10 | 0);\r\n        var y1 = hand[1] % 10;\r\n        var h = this.cellSize - 1 * this.cellSize / 5;\r\n        var w = this.cellSize - 1 * this.cellSize / 5;\r\n        var x = x1 * this.cellSize + this.cellSize / 10;\r\n        var y = y1 * this.cellSize + this.cellSize / 10;\r\n        var shadow_start_x = x + w / 2;\r\n        var shadow_start_y = y + h / 2;\r\n        var shadow_end_x = shadow_start_x;\r\n        var shadow_end_y = shadow_start_y;\r\n        var number = wkMap[hand[1]];\r\n        var wkColor = '';\r\n        var center = 0;\r\n        var grad;\r\n        if (hand.length != 2) {\r\n            return this.canv_shadow;\r\n        }\r\n        if (number > 0) {\r\n            wkColor = this.COLOR_BLUE; // \"#EAEFFD\";   \r\n        }\r\n        else {\r\n            wkColor = this.COLOR_RED; // \"#FDEAFA\";           \r\n        }\r\n        if (x0 == x1 || y0 == y1) { // 直角移動\r\n            if ((x0 + y0) % 2 === 0 && y0 !== 0 && y0 != 5) {\r\n                center = 0.5;\r\n            }\r\n            else {\r\n                center = 0.3;\r\n            }\r\n            if (x0 < x1) {\r\n                x = x - w + 10;\r\n                shadow_end_x = shadow_end_x - w;\r\n            }\r\n            if (x0 > x1) {\r\n                x = x + w - 10;\r\n                shadow_end_x = shadow_end_x + w;\r\n            }\r\n            if (y0 < y1) {\r\n                y = y - h + 10;\r\n                shadow_end_y = shadow_end_y - h;\r\n            }\r\n            if (y0 > y1) {\r\n                y = y + h - 10;\r\n                shadow_end_y = shadow_end_y + h;\r\n            }\r\n            grad = ctx_shadow.createLinearGradient(shadow_start_x, shadow_start_y, shadow_end_x, shadow_end_y);\r\n            grad.addColorStop(0, wkColor);\r\n            grad.addColorStop(center, wkColor);\r\n            grad.addColorStop(1, 'rgba(255, 255, 255, 0)');\r\n            ctx_shadow.fillStyle = grad;\r\n            ctx_shadow.fillRect(x, y, h, w);\r\n        }\r\n        else { // 斜め移動\r\n            if ((x0 + y0) % 2 === 0 && y0 !== 0 && y0 != 5) {\r\n                center = 0.3;\r\n            }\r\n            else {\r\n                center = 0.5;\r\n            }\r\n            var _a = [0, 0, 0, 0, 0, 0, 0, 0], px1 = _a[0], py1 = _a[1], px2 = _a[2], py2 = _a[3], px3 = _a[4], py3 = _a[5], px4 = _a[6], py4 = _a[7];\r\n            if (x0 < x1 && y0 < y1) {\r\n                px1 = x;\r\n                py1 = y - h;\r\n                px2 = x + w;\r\n                py2 = y;\r\n                px3 = x;\r\n                py3 = y + h;\r\n                px4 = x - w;\r\n                py4 = y;\r\n                shadow_end_x = shadow_end_x - w;\r\n                shadow_end_y = shadow_end_y - h;\r\n                shadow_start_x = shadow_start_x + w * 2;\r\n                shadow_start_y = shadow_start_y + h * 2;\r\n            }\r\n            if (x0 > x1 && y0 > y1) {\r\n                px1 = x + w;\r\n                py1 = y;\r\n                px2 = x + w + w;\r\n                py2 = y + h;\r\n                px3 = x + w;\r\n                py3 = y + h + h;\r\n                px4 = x;\r\n                py4 = y + h;\r\n                shadow_end_x = shadow_end_x + w;\r\n                shadow_end_y = shadow_end_y + h;\r\n                shadow_start_x = shadow_start_x - w * 2;\r\n                shadow_start_y = shadow_start_y - h * 2;\r\n            }\r\n            if (x0 < x1 && y0 > y1) {\r\n                px1 = x;\r\n                py1 = y;\r\n                px2 = x + w;\r\n                py2 = y + h;\r\n                px3 = x;\r\n                py3 = y + h + h;\r\n                px4 = x - w;\r\n                py4 = y + h;\r\n                shadow_end_x = shadow_end_x - w;\r\n                shadow_end_y = shadow_end_y + h;\r\n                shadow_start_x = shadow_start_x + w * 2;\r\n                shadow_start_y = shadow_start_y - h * 2;\r\n            }\r\n            if (x0 > x1 && y0 < y1) {\r\n                px1 = x + w;\r\n                py1 = y - h;\r\n                px2 = x + w + w;\r\n                py2 = y;\r\n                px3 = x + w;\r\n                py3 = y + h;\r\n                px4 = x;\r\n                py4 = y;\r\n                shadow_end_x = shadow_end_x + w;\r\n                shadow_end_y = shadow_end_y - h;\r\n                shadow_start_x = shadow_start_x - w * 2;\r\n                shadow_start_y = shadow_start_y + h * 2;\r\n            }\r\n            ctx_shadow.beginPath();\r\n            ctx_shadow.moveTo(px1, py1);\r\n            ctx_shadow.lineTo(px2, py2);\r\n            ctx_shadow.lineTo(px3, py3);\r\n            ctx_shadow.lineTo(px4, py4);\r\n            ctx_shadow.lineTo(px1, py1);\r\n            ctx_shadow.closePath();\r\n            grad = ctx_shadow.createLinearGradient(shadow_start_x, shadow_start_y, shadow_end_x, shadow_end_y);\r\n            grad.addColorStop(0, wkColor);\r\n            grad.addColorStop(center, wkColor);\r\n            grad.addColorStop(0.97, 'rgba(255, 255, 255, 0)');\r\n            ctx_shadow.fillStyle = grad;\r\n            ctx_shadow.fill();\r\n        }\r\n        return this.canv_shadow;\r\n    };\r\n    /**\r\n     * メッセージを描画\r\n     */\r\n    BoardGamejs.prototype.drawOverlay = function () {\r\n        var ctx_overlay = this.canv_overlay.getContext('2d');\r\n        var x = this.cellSize * 1.3;\r\n        var y = this.cellSize * 2.5;\r\n        ctx_overlay.clearRect(0, 0, this.CANV_SIZE, this.CANV_SIZE);\r\n        if (this.message === '') {\r\n            return this.canv_overlay;\r\n        }\r\n        ctx_overlay.shadowBlur = 10;\r\n        ctx_overlay.shadowColor = 'rgba(100, 100, 100, 0.5)';\r\n        ctx_overlay.shadowOffsetX = 5;\r\n        ctx_overlay.shadowOffsetY = 5;\r\n        ctx_overlay.globalAlpha = 0.9;\r\n        ctx_overlay.fillStyle = this.COLOR_WHITE;\r\n        this.fillRoundRect(ctx_overlay, x, y, this.cellSize * 3.4, this.cellSize * 1, this.cellSize / 20);\r\n        var fontsize = Math.round(this.cellSize * 0.36);\r\n        ctx_overlay.shadowBlur = 0;\r\n        ctx_overlay.shadowOffsetX = 0;\r\n        ctx_overlay.shadowOffsetY = 0;\r\n        ctx_overlay.shadowColor = 'rgba(0, 0, 0, 0)';\r\n        ctx_overlay.font = 'bold ' + fontsize + 'px Play,sans-serif';\r\n        ctx_overlay.globalAlpha = 1;\r\n        ctx_overlay.fillStyle = this.COLOR_LINE;\r\n        ctx_overlay.textBaseline = 'middle';\r\n        ctx_overlay.textAlign = 'center';\r\n        ctx_overlay.beginPath();\r\n        ctx_overlay.fillText(this.message, this.cellSize * 3, this.cellSize * 3);\r\n        return this.canv_overlay;\r\n    };\r\n    /**\r\n     * メッセージを更新\r\n     */\r\n    BoardGamejs.prototype.updateMessage = function () {\r\n        this.calcScore();\r\n        var Block = '';\r\n        document.querySelector('#blue').innerHTML = 'Blue: ' + this.blueScore + '/8';\r\n        document.querySelector('#red').innerHTML = ' Red: ' + this.redScore + '/8';\r\n        document.querySelector('#time').innerHTML = '(' + (this.thinktime.toFixed(3)) + 'sec)';\r\n        if (this.logArray.length === 0) {\r\n            if (this.winner == 1) {\r\n                this.message = 'You win!';\r\n                this.storage.setItem('level_' + document.querySelector('#level').value, parseInt(this.storage.getItem('level_' + document.querySelector('#level').value)) + 1);\r\n                this.endgame();\r\n            }\r\n            else if (this.winner == -1) {\r\n                this.message = 'You lose...';\r\n                this.storage.setItem('level_' + document.querySelector('#level').value, 0);\r\n                this.endgame();\r\n            }\r\n            else if (this.winner === 0) {\r\n                if (this.map_list[JSON.stringify(this.thisMap)] >= this.LIMIT_1000DAY) {\r\n                    this.message = '3fold repetition';\r\n                }\r\n                else {\r\n                    this.message = '-- Draw --';\r\n                }\r\n                this.endgame();\r\n            }\r\n        }\r\n        if (this.storage.getItem('level_' + document.querySelector('#level').value) > 0) {\r\n            document.querySelector('#wins').innerHTML = this.storage.getItem('level_' + document.querySelector('#level').value) + ' win!';\r\n        }\r\n        else {\r\n            document.querySelector('#wins').innerHTML = '';\r\n        }\r\n    };\r\n    /**\r\n     * ゲーム終了\r\n     */\r\n    BoardGamejs.prototype.endgame = function () {\r\n        if (this.logArray.length === 0) {\r\n            document.querySelector('#span_replay').classList.remove(\"hide\");\r\n            document.querySelector('#span_tweetlog').classList.remove(\"hide\");\r\n        }\r\n    };\r\n    /**\r\n     * 得点計算。\r\n     */\r\n    BoardGamejs.prototype.calcScore = function () {\r\n        var sum1 = 0;\r\n        var sum2 = 0;\r\n        var GoalTop = [0, 10, 20, 30, 40, 50];\r\n        var GoalBottom = [5, 15, 25, 35, 45, 55];\r\n        // 点数勝利        \r\n        for (var i in GoalTop) {\r\n            if (this.thisMap[GoalTop[i]] * 1 > 0) {\r\n                sum1 += this.thisMap[GoalTop[i]];\r\n            }\r\n        }\r\n        for (var i in GoalBottom) {\r\n            if (this.thisMap[GoalBottom[i]] * -1 > 0) {\r\n                sum2 += this.thisMap[GoalBottom[i]];\r\n            }\r\n        }\r\n        if (sum1 >= 8) {\r\n            this.winner = 1;\r\n        }\r\n        else if (sum2 <= -8) {\r\n            this.winner = -1;\r\n        }\r\n        // 手詰まりは判定\r\n        if (this.isNoneNode(this.thisMap)) {\r\n            if (Math.abs(sum1) > Math.abs(sum2)) {\r\n                this.winner = 1;\r\n            }\r\n            else if (Math.abs(sum1) < Math.abs(sum2)) { // 引き分けは後攻勝利\r\n                this.winner = -1;\r\n            }\r\n            else if (Math.abs(sum1) == Math.abs(sum2)) {\r\n                this.winner = 0;\r\n            }\r\n        }\r\n        else {\r\n            if (this.is1000day(this.thisMap) === true) {\r\n                this.winner = 0;\r\n            }\r\n        }\r\n        this.blueScore = Math.abs(sum1);\r\n        this.redScore = Math.abs(sum2);\r\n    };\r\n    /**\r\n     * 手詰まり判定。\r\n     */\r\n    BoardGamejs.prototype.isNoneNode = function (wkMap) {\r\n        var flag1 = false;\r\n        var flag2 = false;\r\n        for (var panel_num in wkMap) {\r\n            if (wkMap[panel_num] === 0) {\r\n                continue;\r\n            }\r\n            var canMove = Aijs.getCanMovePanelX(parseInt(panel_num), wkMap);\r\n            if (canMove.length !== 0) {\r\n                if (wkMap[panel_num] > 0) {\r\n                    flag1 = true;\r\n                }\r\n                else if (wkMap[panel_num] < 0) {\r\n                    flag2 = true;\r\n                }\r\n            }\r\n            if (flag1 && flag2) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * 千日手\r\n     */\r\n    BoardGamejs.prototype.is1000day = function (wkMap) {\r\n        var map_json = JSON.stringify(wkMap);\r\n        if (this.map_list[map_json] === undefined) {\r\n            this.map_list[map_json] = 1;\r\n            return false;\r\n        }\r\n        else {\r\n            this.map_list[map_json] += 1;\r\n        }\r\n        if (this.map_list[map_json] >= this.LIMIT_1000DAY) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    /**\r\n     * 手の数を取得\r\n     */\r\n    BoardGamejs.prototype.getNodeCount = function (wkMap) {\r\n        var count = 0;\r\n        for (var panel_num in wkMap) {\r\n            if (wkMap[panel_num] === 0) {\r\n                continue;\r\n            }\r\n            var canMove = Aijs.getCanMovePanelX(parseInt(panel_num), wkMap);\r\n            count += canMove.length;\r\n        }\r\n        return count;\r\n    };\r\n    /**\r\n     * パラメータ取得\r\n     */\r\n    BoardGamejs.prototype.getParam = function () {\r\n        var obj = {};\r\n        if (1 < document.location.search.length) {\r\n            var paramstr = document.location.search.substring(1).split('&');\r\n            for (var i = 0; i < paramstr.length; i++) {\r\n                var entry = paramstr[i].split('=');\r\n                var key = decodeURIComponent(entry[0]);\r\n                var value = decodeURIComponent(entry[1]);\r\n                obj[key] = decodeURIComponent(value);\r\n            }\r\n        }\r\n        return obj;\r\n    };\r\n    /**\r\n     * パタメータから初期配置を取得\r\n     */\r\n    BoardGamejs.prototype.getMapByParam = function (initString) {\r\n        var wkMap;\r\n        if (initString) {\r\n            wkMap = Aijs.copyMap(this.thisMap);\r\n            // クリア\r\n            for (var num in wkMap) {\r\n                wkMap[num] = 0;\r\n            }\r\n            var arr = initString.split(',');\r\n            if (arr.length < 8) {\r\n                arr = [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\"];\r\n            }\r\n            var red_num = [0, 10, 20, 30, 40, 50, 11, 41];\r\n            var blue_num = [55, 45, 35, 25, 15, 5, 44, 14];\r\n            for (var num in blue_num) {\r\n                wkMap[blue_num[num]] = parseInt(arr[num]);\r\n            }\r\n            for (var num in red_num) {\r\n                wkMap[red_num[num]] = -1 * parseInt(arr[num]);\r\n            }\r\n        }\r\n        return wkMap;\r\n    };\r\n    /**\r\n     * ログをデコード。\r\n     */\r\n    BoardGamejs.prototype.decodeLog = function (logstr, wkInitMap) {\r\n        var wklogArray = [];\r\n        var wkMap = Aijs.copyMap(wkInitMap);\r\n        var arrow = {\r\n            'q': 0, 'w': 1, 'e': 2,\r\n            'a': 3, 's': 4, 'd': 5,\r\n            'z': 6, 'x': 7, 'c': 8\r\n        };\r\n        logstr = logstr.replace(/q/g, 'q,').replace(/w/g, 'w,').replace(/e/g, 'e,');\r\n        logstr = logstr.replace(/a/g, 'a,').replace(/s/g, 's,').replace(/d/g, 'd,');\r\n        logstr = logstr.replace(/z/g, 'z,').replace(/x/g, 'x,').replace(/c/g, 'c,');\r\n        var logArr = logstr.split(',');\r\n        wklogArray.push(wkMap);\r\n        for (var i = 0; i < logArr.length; i++) {\r\n            if (logArr[i] === '') {\r\n                continue;\r\n            }\r\n            var arw = arrow[logArr[i].match(/[qweasdzxc]/)[0]];\r\n            var from = parseInt(logArr[i].match(/\\d*/)[0]);\r\n            var to = (Math.floor(from / 10) + Math.floor(arw % 3) - 1) * 10 +\r\n                (Math.floor(from % 10) + Math.floor(arw / 3) - 1);\r\n            wkMap = Aijs.copyMap(wkMap);\r\n            wkMap[to] = wkMap[from];\r\n            wkMap[from] = 0;\r\n            wklogArray.push(wkMap);\r\n        }\r\n        return wklogArray;\r\n    };\r\n    /**\r\n     * ログをエンコード\r\n     */\r\n    BoardGamejs.prototype.encodeLog = function (wklogArray) {\r\n        var logstr = '';\r\n        var arrow = ['q', 'w', 'e',\r\n            'a', 's', 'd',\r\n            'z', 'x', 'c'];\r\n        for (var i in wklogArray) {\r\n            var from = wklogArray[i][0];\r\n            var to = wklogArray[i][1];\r\n            var x_vec = ((Math.floor(to / 10)) - Math.floor(from / 10));\r\n            var y_vec = ((Math.floor(to % 10)) - Math.floor(from % 10));\r\n            var arw = '';\r\n            if (x_vec === -1 && y_vec === -1) {\r\n                arw = 'q';\r\n            }\r\n            if (x_vec === 0 && y_vec === -1) {\r\n                arw = 'w';\r\n            }\r\n            if (x_vec === 1 && y_vec === -1) {\r\n                arw = 'e';\r\n            }\r\n            if (x_vec === -1 && y_vec === 0) {\r\n                arw = 'a';\r\n            }\r\n            if (x_vec === 0 && y_vec === 0) {\r\n                arw = 's';\r\n            }\r\n            if (x_vec === 1 && y_vec === 0) {\r\n                arw = 'd';\r\n            }\r\n            if (x_vec === -1 && y_vec === 1) {\r\n                arw = 'z';\r\n            }\r\n            if (x_vec === 0 && y_vec === 1) {\r\n                arw = 'x';\r\n            }\r\n            if (x_vec === 1 && y_vec === 1) {\r\n                arw = 'c';\r\n            }\r\n            logstr += from + arw;\r\n        }\r\n        return logstr;\r\n    };\r\n    /**\r\n     * ログを全部巻き戻す\r\n     */\r\n    BoardGamejs.prototype.move_start = function () {\r\n        this.logPointer = 0;\r\n        this.autoLog = false;\r\n        this.thisMap = Aijs.copyMap(this.logArray[this.logPointer]);\r\n        this.winner = null;\r\n        this.goaled = false;\r\n        this.updateMessage();\r\n        this.flush(false, false);\r\n    };\r\n    /**\r\n     * ログを戻す\r\n     */\r\n    BoardGamejs.prototype.move_prev = function () {\r\n        if (this.logPointer <= 0) {\r\n            return;\r\n        }\r\n        this.autoLog = false;\r\n        this.logPointer -= 1;\r\n        this.thisMap = Aijs.copyMap(this.logArray[this.logPointer]);\r\n        this.winner = null;\r\n        this.goaled = false;\r\n        this.updateMessage();\r\n        this.flush(false, false);\r\n    };\r\n    /**\r\n     * ログを進める\r\n     */\r\n    BoardGamejs.prototype.move_next = function () {\r\n        if (this.logPointer + 1 > this.logArray.length - 1) {\r\n            return;\r\n        }\r\n        this.logPointer += 1;\r\n        this.thisMap = Aijs.copyMap(this.logArray[this.logPointer]);\r\n        this.updateMessage();\r\n        this.flush(false, false);\r\n    };\r\n    /**\r\n     * ログを最後まで進める。\r\n     */\r\n    BoardGamejs.prototype.move_end = function () {\r\n        this.logPointer = this.logArray.length - 1;\r\n        this.autoLog = false;\r\n        this.thisMap = Aijs.copyMap(this.logArray[this.logPointer]);\r\n        this.updateMessage();\r\n        this.flush(false, false);\r\n    };\r\n    /**\r\n     * リセット\r\n     */\r\n    BoardGamejs.prototype.reloadnew = function () {\r\n        var url = document.location.href.split('?')[0];\r\n        //demo中ならdemoを終了\r\n        if (this.demo === true) {\r\n            this.ev_mouseClick(null);\r\n            return;\r\n        }\r\n        // パラメータを取得\r\n        var paramObj = this.getParam();\r\n        if (paramObj.lang) {\r\n            url += '?lang=' + paramObj.lang;\r\n        }\r\n        if (navigator.onLine) {\r\n            location.href = url;\r\n        }\r\n        else {\r\n            this.thisMap = Aijs.copyMap(this.startMap);\r\n            this.shuffleBoard();\r\n            this.logArray2 = [];\r\n            this.message = '';\r\n            this.winner = null;\r\n            this.turn_player = 1;\r\n            this.flush(false, false);\r\n        }\r\n    };\r\n    /**\r\n     * 検討画面に飛ぶ\r\n     */\r\n    BoardGamejs.prototype.jumpkento = function () {\r\n        var url = document.location.href.split('?')[0];\r\n        var init = '?init=' + this.startMap[55] + ',' +\r\n            this.startMap[45] + ',' +\r\n            this.startMap[35] + ',' +\r\n            this.startMap[25] + ',' +\r\n            this.startMap[15] + ',' +\r\n            this.startMap[5] + ',' +\r\n            this.startMap[44] + ',' +\r\n            this.startMap[14];\r\n        var log = '&log=' + this.encodeLog(this.logArray2);\r\n        log += '&lv=' + document.querySelector('#level').value;\r\n        location.href = url + init + log;\r\n    };\r\n    /**\r\n     * ログをツイートする。\r\n     */\r\n    BoardGamejs.prototype.tweetlog = function () {\r\n        var url = document.location.href.split('?')[0];\r\n        var init = '?init=' + this.startMap[55] + ',' +\r\n            this.startMap[45] + ',' +\r\n            this.startMap[35] + ',' +\r\n            this.startMap[25] + ',' +\r\n            this.startMap[15] + ',' +\r\n            this.startMap[5] + ',' +\r\n            this.startMap[44] + ',' +\r\n            this.startMap[14];\r\n        var log = '%26log=' + this.encodeLog(this.logArray2);\r\n        log += '%26lv=' + document.querySelector('#level').value;\r\n        window.open('https://twitter.com/intent/tweet?text=' + url + init + log + '%20%23colamone');\r\n    };\r\n    /**\r\n     * ツイートボタンを読み込む。\r\n     */\r\n    BoardGamejs.prototype.setTweet = function () {\r\n        /*jshint -W030 */\r\n        (function f(d, s, id) {\r\n            var js, fjs = d.getElementsByTagName(s)[0];\r\n            if (!d.getElementById(id)) {\r\n                js = d.createElement(s);\r\n                js.id = id;\r\n                js.async = true;\r\n                js.src = 'https://platform.twitter.com/widgets.js';\r\n                fjs.parentNode.insertBefore(js, fjs);\r\n            }\r\n        })(document, 'script', 'twitter-wjs');\r\n    };\r\n    /**\r\n     * botかどうか判定\r\n     */\r\n    BoardGamejs.prototype.isBot = function () {\r\n        var ua = window.navigator.userAgent.toLowerCase();\r\n        if (ua.indexOf('bot') != -1 ||\r\n            ua.indexOf('lighthouse') != -1 ||\r\n            ua.indexOf('headless') != -1) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    return BoardGamejs;\r\n}());\r\nexport { BoardGamejs };\r\nvar bg = new BoardGamejs();\r\n/**\r\n * init\r\n */\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n    bg.Run();\r\n});\r\n"],"sourceRoot":""}